\ifsolo
    ~

    \vspace{1cm}

    \begin{center}
        \textbf{\LARGE Arithmétique} \\[1em]
    \end{center}
    \tableofcontents
\else
    \minitoc
\fi
\thispagestyle{empty}

\ifsolo \newpage \setcounter{page}{1} \fi
\section{Arithmétique classique}

\subsection{Rappels}

On se place dans l'anneau $(\mathbb Z, +, \times)$, et on note $\mathbb P$ l'ensemble des nombres premiers.

\begin{thm}[Division Euclidienne]
    \index{division euclidienne} Pour $a, b\in\mathbb Z$, $b$ non nul, il existe des uniques entiers $q, r$ tels que \[
        a=qb+r\qquad \qquad \text{ et } 0\leq r<|b|
    \]
\end{thm}

\begin{rem}
    L'existence d'un tel $r$ montre que $\mathbb Z$ est euclidien pour le stathme $|\cdot|$
\end{rem}

\begin{thm}[Théorème fondamental de l'arithmétique]
    Tout entier relatif $n$ non nul s'écrit de manière\index{théorème fondamental de l'arithmétique} unique (à l'ordre près des facteurs et à une constante inversible près) comme produit de puissances de premiers: \[
        \forall n\in\mathbb Z^\star, \exists! p_1, \cdots, p_r\in\mathbb P, \exists! \alpha_1, \cdots, \alpha_r\in\mathbb N^\star, \exists \epsilon\in\mathcal U_{\mathbb Z}=\{-1, 1\}, \qquad n=\epsilon p_1^{\alpha_1}\cdots p_r^{\alpha_r}
    \]
\end{thm}

\begin{thmdef}[Bézout, PGCD]
    Pour $a, b\in\mathbb Z$, il existe un unique entier positif $d$ tel que $a\mathbb Z+b\mathbb Z=d\mathbb Z$. On appelle cet entier le PGCD de $a$ et $b$, et on le note $d=a\land b=(a, b)=\mathrm{PGCD}(a, b)$. Si $d=a\land b$ alors il existe $u, v\in \mathbb Z$ tels que $au+bv=d$ (c'est la  propriété de Bézout)\index{Bézout (théorème de -- )}
\end{thmdef}

\begin{rem}
    Cette définition du PGCD coïncide avec la définition usuelle.
\end{rem}

\begin{thmdef}[Identité de Bézout, Coprimalité]
    Deux entiers $a$ et $b$ sont dits premiers entre eux si les ensembles de leurs diviseurs stricts sont disjoints. C'est équivalent à \[
        \exists u, v\in\mathbb Z, \qquad au+bv=1
    \]
\end{thmdef}

\begin{thm}[Lemme de Gauss]
    \index{Gauss!lemme} Si $a, b, c\in \mathbb Z$ et $a\land c=1$ alors \[
        a\;|\;bc\implies a\;|\; b
    \]
\end{thm}

\subsection{Utilisation d'un Vandermonde}

On note $a_1, \cdots, a_n\in\mathbb Z$. On veut montrer que \[
    \prod_{1\leq i<j\leq n}(j-i)\;\Big|\; \prod_{1\leq i<j\leq n}(a_j-a_i)
\]

On introduit \[
    \Delta(X_1, \cdots, X_n)= \begin{vmatrix}
        \binom{X_1}0 & \cdots & \binom{X_1}{n-1} \\
        \vdots & \ddots & \vdots \\
        \binom{X_n}0 & \cdots & \binom{X_n}{n-1}
    \end{vmatrix}\qquad \text{ avec }\binom Xk=\frac{X(X-1)\cdots (X-k+1)}{k!}
\]
On a \[
    \binom X{n-1}=\frac{X^{n-1}}{(n-1)!}+\underbrace{c_{n-2}X^{n-2}+\cdots +c_0}_{\in \Vect \left( \binom X0, \cdots, \binom X{n-2} \right)}
\]
de sorte que dans le déterminant on peut remplacer la dernière colonne par \[
    \begin{pmatrix}
        \frac{X_1^{n-1}}{(n-1)!} \\
        \vdots \\
        \frac{X_n^{n-1}}{(n-1)!}
    \end{pmatrix}
\]
et en itérant sur les colonnes de droite à gauche, \[
    \Delta(X_1, \cdots, X_n)= \begin{vmatrix}
        \;\;\;1\;\; & \dfrac{X_1}1 & \cdots & \dfrac{X_1^{n-1}}{(n-1)!} \\
        \;\vdots & \ddots & \ddots & \vdots \\
        \;\vdots & \ddots & \ddots & \vdots \\
        \;\;\;1\;\; & \cdots & \cdots & \dfrac{X_n^{n-1}}{(n-1)!}
    \end{vmatrix}
\]
et \[
    \Delta(a_1, \cdots, a_n)=\frac1{1!2!\cdots (n-1)!}V(a_1, \cdots, a_n)=\frac1{\prod_{1\leq i<j\leq n}(j-i)}\prod_{1\leq i<j\leq n}(a_j-a_i)
\]
or $\Delta(a_1, \cdots, a_n)$ est bien un entier car les $\binom{a_i}k$ sont des entiers, ce qui conclut.

\subsection{Méthode de la descente infinie}

On note $p$ premier et pour $n\geq 3$, on considère l'équation $x^n+py^n=p^2z^n$.
\begin{itemize}
    \item $(0, 0, 0)$ est solution. On suppose qu'il y en a d'autres et on note $(x, y, z)\neq (0, 0, 0)$ une solution minimale pour $|x|+|y|+|z|$.
    \item On a $p\;|\;p^2z^n-py^n=x^n$ donc $p$ divise $x$: on écrit $x=px'$. On a \[
            p^{n-1}x'^n+y^n=pz^n
        \]
        donc $p$ divise $y$ qu'on écrit $y=py'$ et donc $p$ divise $z$ qui s'écrit $z=pz'$. On a ainsi trouvé une nouvelle solution $(x', y', z')$ strictement inférieure à la précédente, ce qui est absurde. Ainsi, la seule solution est la solution nulle.
\end{itemize}

\subsection{Formule de Legendre}

\begin{dfn}
    \index{valuation $p$-adique} Pour tout premier $p$, on définit la \textbf{valuation $\bm p$-adique} $v_p$ par : \[
        v_p: n\in\mathbb Z^\star \longmapsto \max\{k\in\mathbb N, \quad p^k\;|\; n\}
    \]
\end{dfn}

On va montrer la formule de Legendre\index{Legendre!formule}: \[
    v_p(n!)=\sum_{i=1}^{+\infty}\floor{\frac n{p^i}}
\]
Pour cela, on remarque \[
    v_p(n!)=\sum_{m=1}^nv_p(m)=\sum_{m=1}^n\sum_{k=1}^{v_p(m)}1=\sum_{k=1}^{+\infty}\sum_{\substack{k\leq v_p(m)\\ 1\leq m\leq n}}1=\sum_{k=1}^{+\infty}\sum_{d\leq m=p^ku\leq n}1=\sum_{k=1}^{+\infty}\floor{\frac n{p^k}}
\]

\begin{exo}[X]
     Pour $m, n\in\mathbb N$, montrer \[
        \frac{(2m)!(2n)!}{(m+n)!n!m!}\in\mathbb N
     \]
\end{exo}

\subsection{Coefficients du binôme}

\todo{Retrouver ça}

\section{L'anneau $\mathbb Z_n$}

Soit $A$ un anneau commutatif et $I$ un idéal de $A$. On définit la relation d'équivalence suivante: $x\mathcal Ry\iff x-y\in I$. On note $A/I$ l'ensemble des classes d'équivalences: c'est un anneau commutatif avec les lois $\bar{x+y}=\bar x+\bar y$ et $\bar{x\times y}=\bar x\times \bar y$.

Pour $A=\mathbb Z$, $I=n\mathbb Z$, il y a $n$ classes d'équivalence dans $\mathbb Z_n\defeq\mathbb Z/n\mathbb Z$, ce sont les $\bar 0, \cdots , \bar{n-1}$.

\section{Groupe $\mathbb Z_n^\star$ des inversibles de $\mathbb Z_n$}

\begin{prop}
    \begin{itemize}
        \item La classe de $a\in\mathbb Z$ est inversible dans $\mathbb Z_n$ si et seulement si $a\land n=1$
        \item $\#\mathbb Z_n^\star=\varphi(n)$
        \item (Euler\index{Euler!théorème (arithmétique modulaire)}) Pour $\bar a$ inversible, $\bar a^{\varphi(n)}\equiv \bar 1\pmod n$
    \end{itemize}
\end{prop}

\begin{proof}~
    \begin{enumerate}
        \item $\bar a\in\mathbb Z_n^\star\iff \exists \bar u\in\mathbb Z_n, \bar a\times \bar u\equiv 1\pmod n\iff \exists u, v\in\mathbb Z, au=1+nv \iff a\land n=1$
        \item C'est évident vu 1.
        \item $\ord(\bar a)\;|\;\#\mathbb Z_n^\star=\varphi(n)$
    \end{enumerate}
\end{proof}

\begin{cor}[Petit théorème de Fermat]
    \index{Fermat!petit théorème} Pour tout $a\in\mathbb Z, \quad \bar a^p\equiv \bar a\pmod p$ pour $p$ premier
\end{cor}

\section{Caractérisations des corps}

\begin{prop}
    $\mathbb Z_n$ est un corps si et seulement si $n$ est premier
\end{prop}

\begin{proof}
    $\varphi(n)=n-1\iff n\in \mathbb P$
\end{proof}

\subsection{Théorème de Wilson}

\begin{res}[Théorème de Wilson]
    $p\geq 3$ est premier si et seulement si $(p-1)!\equiv -1\pmod p$\index{Wilson (théorème de -- )}
\end{res}

\begin{proof}~
    \begin{itemize}
        \item $(\implies)$ Dans $\mathbb Z_p$, $x^2\equiv 1$ n'a que deux solutions: $1$ et $-1$ (car on est dans un corps donc un anneau intègre). Ce sont donc les deux seuls éléments qui sont leurs propres inverses, les autres sont couplés deux à deux dans l'écriture de $(p-1)!$. On a donc \[
                (p-1)!\equiv 1\times (2\times \cdots \times (p-2))\times (p-1)\equiv 1\times (p-1)\equiv -1 \pmod p
            \]
        \item $(\impliedby)$ On note $n\geq 3$ non premier, il s'écrit donc $n=ab$ avec $a\land b=1$ et $a, b\geq 2$. Si $a\neq b$ alors $ab\;|\;(n-1)!$. Sinon, $n=a^2$ et $a\geq 2$ donc $a^2\;|\;(n-1)!$ car $a$ et $2a$ apparaissent dans l'écriture de la factorielle. Dans les deux cas, $(n-1)!\equiv 0\pmod n$
    \end{itemize}
\end{proof}

\subsection{RSA}

On va voir (rapidement) le principe du chiffrement RSA. On choisit $p, q$ des nombres premiers distincts, et on note $n=pq$. On note $a, b$ tels que $ab\equiv 1\pmod{\varphi(n)}$. Les nombres $n$ et $a$ sont publics, et $b$ (qu'on appelle clé privée) n'est connu que de Bob, qui veut recevoir un message chiffré d'alice

Alice veut transmettre $x\in\mathbb Z_n^\star$. Elle calcule $x^n\equiv y\pmod n$, et $y$ est le message chiffré.

Bob calcule $y^b\equiv x^{ab}\equiv x\times x^{\varphi(n)k}\equiv x\pmod n$

\subsection{$\mathbb Z_{p^\alpha}^\star$ pour $p$ premier impair}

\subsubsection{$\mathbb Z_p^\star$ est cyclique}

On va d'abord montrer les résultats suivants, vrais dans tous les groupes abéliens finis: \begin{itemize}
    \item L'ensemble des ordres est stable par ppcm
    \item L'exposant d'un groupe est l'ordre d'un élément
\end{itemize}
On utilisera ensuite la structure de corps de $\mathbb Z/p\mathbb Z$ pour conclure.

Soit $(G, \cdot)$ un groupe abélien fini. On va montrer que l'ensemble des ordres est stable par ppcm. Soient $a, b$ deux éléments d'ordres respectifs $m, n$. On cherche un élément d'ordre $m\lor n$. On note $d=m\land n$ de telle sorte que $m=dm'$, $n=dn'$ et $m\land n'=1$. De cette manière, on a $m\lor n=mn'$
\[
    \ord \left(a\right)=m\qquad \qquad \ord\left(b^d\right)=n'
\]
et donc $c=ab^d$ est un élément d'ordre $mn'=m\lor n$, ce qui conclut.

On définit l'exposant\index{groupe!exposant} $\lambda$ du groupe $G$ comme l'ordre maximal des éléments de $G$. L'ensemble des ordres étant stable par ppcm, et le ppcm de tous les ordres majorant l'ensemble, le maximum des ordres $\lambda$ est le ppcm des ordres des éléments. Puis, la stabilité garantit qu'il existe un élément d'ordre $\lambda$.

On va maintenant montrer que $\mathbb Z_p^\star$ est cyclique. $\mathbb Z_p$ est un corps (déjà vu). Ainsi, un polynôme de $\mathbb Z_p[X]$ admet au plus autant de racines que son degré. On pose $P=X^\lambda-1$. Ce polynôme admet au moins $p-1$ racines distinctes (les éléments non nuls du corps) par définition de $\lambda$. On a donc $\lambda\geq p-1$. Puis, $\lambda$ est un ordre donc divise $\#\mathbb Z_p^\star=p-1$ (Lagrange). Ainsi, $\lambda\mid p-1$ et $\lambda=p-1$.

L'exposant du groupe vaut le cardinal du groupe, ce groupe est donc cyclique (un élément d'ordre $\lambda$ est automatiquement un générateur du groupe).

\subsubsection{$\mathbb Z_{p^\alpha}^\star$ est cyclique}

On va d'abord montrer par récurrence \[
    \forall n\in\mathbb N, \quad (1+p)^{p^n}\equiv 1+p^{n+1}\pmod {p^{n+2}}.
\]

\begin{itemize}
    \item Le cas $n=0$ est direct.
    \item On suppose le résultat vrai au rang $n$: \[
        (1+p)^{p^n}=1+p^{n+1}+p^{n+2}q.
    \]
    On a alors \begin{align*}
        (1+p)^{p^{n+1}}&\equiv(1+p^{n+1}+p^{n+2}q)^p\\
                       &\equiv 1+\sum_{k=1}^{p}\binom pk p^{(n+1)k}(1+pq)^k\\ 
                       &\equiv 1 + p^{n+1}(1+pq)p \\
                       &\equiv 1+p^{n+2}&\pmod{p^{n+3}}.
    \end{align*}
    Donc l'égalité est vraie pour tout entier naturel $n$.
\end{itemize}
Il est suffisant de trouver un élément de $(\mathbb Z/p^\alpha\mathbb Z)^\star$ d'ordre $\varphi(p^\alpha)=(p-1)p^{\alpha-1}$ (cette égalité s'obtient via la définition de l'indicatrice d'Euler), et vu la stabilité des ordres par ppcm vue précédemment, il est suffisant de trouver un élément d'ordre $p-1$ et un élément d'ordre $p^{\alpha-1}$.

On va d'abord exhiber un élément d'ordre $p^{\alpha-1}$. On a 
\[
(1+p)^{p^{\alpha-2}} 
\equiv 1+p^{\alpha-1}\pmod {p^\alpha}    \]
et \[
    (1+p)^{p^{\alpha-1}}\equiv 1\pmod {p^\alpha}.
\]
Donc $\ord(1+p)\mid p^{\alpha-1}$ mais $\ord(1+p)\nmid p^{\alpha-2}$ donc $\ord(1+p)=p^{\alpha-1}$.

Il reste à trouver un élément d'ordre $p-1$. On sait que $\mathbb Z_p^\star$ est cyclique, on note $g$ un générateur. On a:
\[
    \forall k<p-1, \quad p\;\nmid\;g^k-1\quad \text{ie}\quad p^\alpha\;\nmid\; g^k-1
\]
et $p\mid g^{p-1}-1$ donc $\ord g=k(p-1)$ est $g^k$ et d'ordre $p-1$.

\section{Théorème chinois}

\begin{thm}
    \Hyp $m, n\in\mathbb N^\star$, $m\land n=1$
    \begin{concenum}
    \item La classe de $\bar x\in\mathbb Z_{mn}$ dans $\mathbb Z_n$ ne dépend pas du choix de représentant dans $\mathbb Z_{mn}$
    \item L'application \[
            \begin{matrix}
                \varphi: & \mathbb Z_{m, n} & \longrightarrow & \mathbb Z_n\times \mathbb Z_m \\
                         & \bar x &\longmapsto & (\bar x, \bar x)
            \end{matrix}
        \]
        est un isomorphisme d'anneaux
    \item $\varphi$ est une bijection de $\mathbb Z_{m, n}^\star$ dans $\mathbb Z_n^\star \times \mathbb Z_m^\star$
    \item Pour $a, b\in\mathbb Z$ fixés, le système \[
            \begin{cases}
                x=a\pmod n\\
                x=b\pmod m
            \end{cases}
        \]
        admet une unique solution modulo $mn$
    \end{concenum}
\end{thm}

\begin{proof}~
    \begin{enumerate}
        \item $a, b$ de représentants de $\bar x$ dans $\mathbb Z_{m, n}$. $a\equiv b\pmod mn\implies a\equiv b\pmod n$ donc $\bar a=\bar b$ dans $\mathbb Z_n$
        \item C'est bien un morphisme, il est injectif car $\Ker\varphi=\{\bar 0\}$ donc c'est un isomorphisme car les ensembles d'antécédents et d'images sont équipotents finis.
        \item C'est clair ($a\land n\neq 1\implies a\land mn\neq 1$ d'où on déduit l'injectivité).
        \item C'est 2.
    \end{enumerate}
\end{proof}

\begin{rem}
    Le point 3. donne la multiplicativité de l'indicatrice d'euler: pour $m, n$ premiers entre eux, $\varphi(mn)=\varphi(m)\varphi(n)$
\end{rem}

\begin{rem}
    On peut généraliser le résultat à $n_1, \cdots, n_r$ deux à deux premiers entre eux
\end{rem}

\begin{rem}
    Si $un+vm=1$ alors $x=avm+bun$ est une solution
\end{rem}

\subsection{Puissances parfaites}

On va montrer qu'il existe $n$ entiers consécutifs qui ne sont pas des puissances parfaites.

On note $p_1, \cdots, p_n$ des premiers deux à deux distincts. Le système \[
    \begin{cases}
        x\equiv p_1-1\pmod {p_1^2}\\
        \hspace{1cm}\vdots\\
        x\equiv p_n-n\pmod{p_n^2}
    \end{cases}
\]
possède une solution $x\in\mathbb N$ et $v_{p_i}(x+i)=1$ donc $x+i$ n'est pas une puissance parfaite (car $x+i\neq p_i$ quitte à translater $x$ de $p_1^2\cdots p_n^2$)

\subsection{Points visibles}

\begin{center}
    \includegraphics{src/figures/arithmetique-points-visibles.pdf}
\end{center}

On considère l'ensemble des points (qu'on appelle \emph{points visibles}) de $\mathbb Z^2$ tels que pour un point $(x, y)$, l'ensemble $\{(1-t)(0, 0)+t(x, y), \quad t\in ]0, 1[\}$ ne contient pas de point de $\mathbb Z^2$. On veut montrer qu'il existe des rectangles pleins arbitrairement grands dans cet ensemble, c'est à dire que pour tout $n\in\mathbb N$, il existe $(a, b)$ tel que $\forall i, j\leq n, (a+i, a+j)$ est invisible.

On vérifie facilement que cet ensemble est l'ensemble $\{(a, b)\in\mathbb Z^2, \quad a\land b=1\}$. On note $A$ une matrice $k\times k$ dont les coefficients sont des nombres premiers deux à deux distincts. On note $m_i$ le produit de la $i$-ième ligne, $M_i$ le produit de la $i$-ième colonne. Le théorème chinois donne l'existence de $a$, $b$ tels que \[
    \begin{cases}
        a\equiv -1\pmod {m_1} \\
        \hspace{.4cm}\vdots \\
        a\equiv -k\pmod{m_k}
    \end{cases}
    \qquad \begin{cases}
        b\equiv -1\pmod {M_1}\\
        \hspace{.4cm}\vdots \\
        b\equiv -k\pmod{M_k}
    \end{cases}
\]
de sorte que $(a+i)\land (b+j)$ est divisible par $m_i\land M_j\neq 1$.

\subsection{Les congruences de Lucas}

On note $p\in\mathbb P$ et \[
    n\defeq\sum_{k=0}^Na_kp^k\geq \sum_{k=0}^Nb_kp^k\defeq m
\]
On va montrer que \[
    \binom nm\equiv \binom{a_0}{b_0}\cdots \binom{a_N}{b_N}\pmod p
\]

On a $(1+X)^p=1+X^p$ dans $\mathbb Z_p[X]$. Puis, \[
    (1+X)^n=\prod_{i=0}^N((1+X)^p)^{a_i}=\prod_{i=0}^n\sum_{k=0}^{a_i}\binom{a_i}{k}X^{kp^i}
\]
et il suffit d'identifier le coefficient de $X^m$

\section{Principe d'inclusion-exclusion}

Pour $E$ fini, $A_1, \cdots, A_N\in\mathcal P(E)$, \[
    \#A_1\cup\cdots \cup A_N=\sum_{i_1=1}^N\#A_{i_1}-\sum_{i_1<i_2}\#A_{i_1}\cap A_{i_2}+\cdots +(-1)^{N-1}\sum_{i_1<\cdots <i_N}\#A_1\cap \cdots \cap A_N
\]

Pour le voir, on remarque: \[
    \sum_{x\in E}\1_{A}(x)=\#A \qquad\quad \1_{A\cap B}=\1_A \cdot \1_B \qquad \quad \1_{A^c}=1-\1_A
\]
et \[
    (A_1\cup \cdots \cup A_N)^c=A_1^c\cap \cdots \cap A_N^c
\]
donc \[
    \mathbbm1_{(A_1\cup \cdots \cup A_N)^c}=\prod_{i=1}^N(1-\1_{A_i^c})
\]
puis on développe le produit et on somme la fonction prise sur les éléments de $E$


\begin{ex}[Application aux permutations sans points fixes]
    On note $d_n$ le nombre de permutations de $\mathfrak S_n$ sans points fixes.

    Il y a $\displaystyle \binom ni d_{n-i}$ permutations qui ont $i$ points fixes donc \[
        n!=\sum_{i=0}^n\binom nid_{n-i}=\sum_{i=0}^n\binom nid_i.
    \]
    Matriciellement, \[
        \begin{pmatrix}
            n!\\[1em]
            \vdots\\[1em]
            \vdots\\[1em]
            0!
            \end{pmatrix}= \underbrace{\begin{pmatrix}
        \displaystyle\binom nn & \cdots & \cdots & \displaystyle\binom n0 \\[1em]
        0 & \displaystyle\binom{n-1}{n-1} & \ddots & \vdots \\[1em]
        \vdots & \ddots & \ddots & \vdots \\[1em]
        0 & \cdots & 0 & \displaystyle\binom 00
    \end{pmatrix}}_{\defeq A_n\in \mathrm{GL}_n(\mathbb R)} \begin{pmatrix}
        d_n\\[1em]
        \vdots \\[1em]
        d_1\\[1em]
        d_0
        \end{pmatrix}
    \]
    On a $A_n^\top=\mathcal {M}_{\text{base canonique}}(f)$ avec $f:P\in\mathbb R_n[X]\longmapsto P(X+1)$. Puis, $(A_n^\top)^{-1}=(A_n^{-1})^\top=\mathcal M(f^{-1})$ or $f^{-1}:P\longmapsto P(X-1)$ d'où \[
        (A_n^{-1})^\top = \begin{pmatrix}
            \displaystyle\binom nn & 0 & \cdots & 0 \\[1em]
            \displaystyle -\binom n{n-1} & \ddots & \ddots & \vdots \\[1em]
            \vdots &  & \ddots & 0 \\[1em]
            (-1)^n\displaystyle\binom n0 & \;\;\;\cdots\;\;\; & \;\;\;\cdots\;\;\; & \displaystyle\binom 00
        \end{pmatrix}
    \]
    d'où \[
        d_n=\sum_{i=0}^n\binom n{n-i}(n-i)!(-1)^i=\sum_{i=0}^n\frac{(-1)^in!}{i!}\sim \frac{n!}e
    \]
\end{ex}

\section{Principe des tiroirs}

\begin{prop}[Principe des tiroirs]
    Si on place $n$ éléments dans $k$ tiroirs, alors l'un des tiroirs contient au moins $\ceil{\frac nk}$ éléments
\end{prop}

\begin{proof}
    Par l'absurde.
\end{proof}

\subsection{Problème d'Erdős}

On choisit $n+1$ éléments distincts de $\llbracket 1, 2n\rrbracket$. On va montrer que l'un divise un autre.

Tous les entiers s'écrivent $2^n(2s+1)$, $2s+1\in\llbracket 1, n\rrbracket$. On en a choisit $n+1$ (parmi $n$ possibilités) donc deux entiers ont la même partie impaire ce qui conclut.

\subsection{Existence d'univers parallèles (moyennant quelques hypothèses physiques)}

On définit un volume de Hubble: une boule de $4\cdot 10^{26}$m de rayon qui contient $10^{115}$ cases contenant ou non un proton.

L'univers est en expansion, donc la lumière se fait rare et il fait noir. Mais, il ne fait pas noir. Donc il y a des volumes de Hubble qui apparaissent.

Il n'y a qu'un nombre fini de volumes de Hubble possibles, ainsi, il y a deux volumes de Hubble identiques dans l'univers.

\subsection{Tiroirs de Dirichlet}

On se donne $\alpha\in\mathbb R\setminus \mathbb Q$. On va montrer qu'il existe une infinité de $(h, k)$ tels que \[
    k>0,\qquad \quad \left| \alpha-\frac hk \right|\leq \frac1{k^2}
\]
On note $\{p\alpha\}=p\alpha-\floor{p\alpha}$ la partie décimale de $p\alpha$ pour $p\in\llbracket 0, n\rrbracket$. Il y a $n+1$ valeurs possibles, donc il existe $k\in\llbracket 0, n-1\rrbracket$ tel que \[
    \{p\alpha\}, \{q\alpha\}\in \left[ \frac kn;\frac {k+1}n \right[,\qquad \text{ et }\qquad p<q
\]
Puis, \[
    |\{p\alpha\}-\{q\alpha\}|=|(q-p)\alpha-(\floor{q\alpha}-\floor{p\alpha})|<\frac1n
\]
donc \[
    \Big|\alpha-\underbrace{\frac{\floor{q\alpha}-\floor{p\alpha}}{q-p}}_{=\frac hk\quad \text{convient}}\Big|<\frac1{n(q-p)}\leq \frac1{(q-p)^2}
\]

S'il y a un nombre fini de $(h, k)$ solutions alors l'un d'eux réalise le minimum ($>0$), donc il existe $n$ tel que \[
    \frac1n<\Big|\alpha-\frac hk\Big|
\]
et vu ce qui précède il existe $p\neq q$ tel que \[
    \left| \alpha-\frac{\floor{q\alpha}-\floor{p\alpha}}{q-p} \right|<\frac1{n|q-p|}\leq \left| \alpha-\frac hk \right|
\]
absurde

\section{Dénombrement de partitions}

Soient $n, p\in\mathbb N^\star$. On appelle partition de $n$ en $p$ parties un $p$-uplet $(x_1, \cdots, x_p)\in\llbracket 0, n\rrbracket ^p$ tel que $x_1+\cdots +x_p=n$

Pour compter les partitions de $n$ en $p$-uplets, on compte le nombre de manière de positionner $p-1$ signes $+$ parmi $n+p-1$ emplacements (le nombre d'emplacements entre le $i$-ième signe $+$ et le $i+1$-ième sera $x_{i+1}$). Le nombre de $p$-partitions de $n$ est donc \[
    \binom{n+p-1}{p-1}
\]

Si on impose que les $x_i$ soient non nuls, alors il n'y a plus que $\displaystyle\binom{n-1}{p-1}$ possibilités.

\section{Une congruence subtile}

On se donne $a, b\in\mathbb N$, $a\geq b$. On va montrer que pour $p$ premier \[
    \binom{pa}{pb}\equiv \binom ab\pmod {p^2}
\]
On considère l'ensemble $E$ des matrices de $\mathcal M_{a,p}(\mathbb Z_2)$ dont tous les coefficients sont nuls sauf $pb$ d'entre eux. On munit $E$ de la relation d'équivalence \[
    A\mathcal RB\iff \exists c_1, \cdots, c_a \text{ permutations circulaires de }\llbracket 1, p\rrbracket, \quad (a_{i, c_i(j)})_{\substack{1\leq i\leq a\\ 1\leq j\leq p}}=A
\]
Par exemple, \[
    \begin{pmatrix}
        {\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\1&{\color{gray}0}&{\color{gray}0}\\{\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\1&{\color{gray}0}&1
    \end{pmatrix}\mathcal R
    \begin{pmatrix}
        {\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\1&{\color{gray}0}&{\color{gray}0}\\{\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\{\color{gray}0}&1&1
    \end{pmatrix}\mathcal R
    \begin{pmatrix}
        {\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\{\color{gray}0}&1&{\color{gray}0}\\{\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\1&1&{\color{gray}0}
    \end{pmatrix}\mathcal R
    \begin{pmatrix}
        {\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\{\color{gray}0}&1&{\color{gray}0}\\{\color{gray}0}&{\color{gray}0}&{\color{gray}0}\\{\color{gray}0}&1&1
    \end{pmatrix}
\]
Les classes d'équivalences sont de cardinal $1$ si et seulement si les lignes ont chacune un seul des coefficients $1$ ou $0$ ($p$ est premier). Il y a $b$ parmi $a$ telles classes. Puis, si une ligne contient deux coefficients distincts alors il y a au moins une autre telle ligne (car on a choisi $pb$ coefficients $1$). Ainsi, si une classe d'équivalence n'est pas un singleton, son cardinal est divisible au moins par $p^2$. On a donc \[
    \binom{pa}{pb}-\binom ab=\sum_{\#\bar x\geq 2}\#\bar x=p^2k
\]
d'où le résultat.

\section{Méthodes combinatoires}

On note $E$ un ensemble fini et $A_1, \cdots, A_k\in\mathcal P(E)$. On va compter les $k$-uplets d'ensembles qui vérifient certaines propriétés

\subsection{Suite croissante pour l'inclusion}

On va démonbrer le nombre de $A_1, \cdots, A_k$ tels que $A_1\subset A_2\subset \cdots\subset A_n$
\[
    \colorboxed{black}{\text{Poubelle}\defeq A_0} \qquad\qquad \colorboxed{black}{A_1}\quad\subset\quad \colorboxed{black}{A_2}\quad\subset\quad \cdots \quad\subset\quad \colorboxed{black}{A_k}
\]
On associe à chaque $x\in E$ le plus petit $i\in\llbracket 1, k\rrbracket$ tel que $x\in A_i$ ($0$ sinon), on note $f:C\to \mathfrak F(E, \llbracket 0, k\rrbracket)$ cette fonction, avec $C$ l'ensemble des $k$-uplets qui satisfont la condition.

Cette fonction est clairement bijective donc $\#C=(k+1)^{\#E}$

\subsection{Union disjointe}

On veux dénombrer le nombre de $k$-uplets tels que $A_i\cap A_j=\emptyset$ pour $i\neq j$
C'est le même principe: on note \[
    f: (A_1, \cdots, A_k)\in C\longmapsto (x\longmapsto \text{ unique }i\text{ tel que }x\in A_i)
\]
avec $A_0$ l'ensemble des éléments qui n'apparaissent dans aucun des $A_i$. Cette application est aussi clairement bijective ce qui permet de conclure.
\endchapter
