\usepackage[french]{babel}
\usepackage[a4paper, margin=2cm]{geometry}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{stmaryrd}
\usepackage{xcolor}
\usepackage{etoolbox}
\usepackage{parskip}
\usepackage{tikz,tkz-tab}
\usepackage{titleps}
\ifsolo
\else
\usepackage{lastpage}
\usepackage[french]{minitoc}
\fi
\usepackage{tocloft}
\usepackage{lmodern}
\usepackage{enumitem}
\usepackage{needspace}
\usepackage{imakeidx}
\usepackage[normalem]{ulem}
\usepackage[hidelinks]{hyperref}

\makeindex[intoc,columns=2,options={-s indexstyle.ist}]
\makeatletter
\def\@idxitem{\par\hangindent 0pt}
\makeatother

\AtBeginDocument{\def\labelitemi{$\bullet$}}
\setlist[itemize]{leftmargin=.5cm}
\setlist[enumerate]{leftmargin=.7cm}

\theoremstyle{definition}
\newtheorem*{thm}{Théorème}
\newtheorem*{thmdef}{Théorème -- Définition}
\newtheorem*{dfn}{Définition}
\newtheorem*{defprop}{Définition -- Proposition}
\newtheorem*{lmm}{Lemme}
\newtheorem*{rem}{Remarque}
\newtheorem*{ex}{Exemple}
\newtheorem*{res}{Résultat}
\newtheorem*{prop}{Proposition}
\newtheorem{csq}{Conséquence}[subsection]
\renewcommand{\thecsq}{\arabic{csq}}
\newtheorem*{cor}{Corollaire}
\newtheorem*{exo}{Exercice}
\newtheorem*{notation}{Notation}

\AtBeginEnvironment{thmdef}{\Needspace{5\baselineskip}}
\AtBeginEnvironment{defprop}{\Needspace{5\baselineskip}}

\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{(\!\emph{\alph{subsection}})}


\setlength{\cftsecnumwidth}{0.6cm}
\renewcommand{\cftsecpresnum}{}
\renewcommand{\cftsecaftersnum}{}


\ifsolo
\addto\captionsfrench{
  \renewcommand{\contentsname}%
    {Plan du cours}%
}
\else
\renewcommand{\thechapter}{\Roman{chapter}}
\mtcsetoffset{minitoc}{-2em}
\renewcommand{\cftsecfont}{\small\bfseries}
\setcounter{tocdepth}{1}
\setlength{\cftchapnumwidth}{1.4cm}
\fi

\newpagestyle{main}{
  \setheadrule{1pt}
  \ifsolo\else \setfootrule{1pt}\fi
  \sethead{\thesection ~--~\textsc{\sectiontitle}}{}{Page \thepage\ifsolo\else~/~\pageref{LastPage}\fi}
  \setfoot{\ifsolo\else\textbf{Chapitre \thechapter} : \textsc{\chaptertitle}\fi}{}{}
}

\DeclareMathOperator{\dom}{dom}
\newcommand{\ord}{\mathrm{ord}}
\newcommand{\Vect}{\mathrm{Vect}}
\newcommand{\diff}{\mathrm{d}}
\DeclareMathOperator{\img}{Im}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Com}{Com}

\newcommand{\todo}[1]{{\color{red}À faire: #1}}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}~}

\newcommand{\hyp}{\circled{H}}
\newcommand{\conc}{\circled{C}}

\newcommand{\Hyp}{~\\[.1cm] \circled{H}\hspace{1em}}
\newcommand{\Conc}{~\\[.1cm] \circled{C}\hspace{1em}}
\newenvironment{concenum}{
~\\[0.1cm]\begin{tabular}{@{}lp{15cm}} \conc & \vspace{-.45cm}
\begin{enumerate}[leftmargin=.5cm]
}
{
\end{enumerate}
\end{tabular}
}

\newcommand*{\colorboxed}{}
\def\colorboxed#1#{%
  \colorboxedAux{#1}%
}
\newcommand*{\colorboxedAux}[3]{%
  % #1: optional argument for color model
  % #2: color specification
  % #3: formula
  \begingroup
    \colorlet{cb@saved}{.}%
    \color#1{#2}%
    \boxed{%
      \color{cb@saved}%
      #3%
    }%
  \endgroup
}

\tocloftpagestyle{empty}
\pagestyle{main}
