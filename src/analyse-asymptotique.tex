\ifsolo
    ~

    \vspace{1cm}

    \begin{center}
        \textbf{\LARGE Analyse Asymptotique} \\[1em]
    \end{center}
    \tableofcontents
\else
    \chapter{Analyse asymptotique}

    \minitoc
\fi
\thispagestyle{empty}

\ifsolo \newpage \setcounter{page}{1} \fi
\section{Développements limités -- Rappels}

Cette section ne contient que des rappels de sup.

\begin{dfn}[Développement limité]\index{développement limité}
    Un développement limité de $f:V\longrightarrow \mathbb R$ à l'ordre $n$ au voisinage $V$ de $a$ (qu'on abrègera $\mathrm{DL}_n(a)$ de $f$) est une écriture du type: \[
        f(x)=\underbrace{a_0+a_1(x-a)+\cdots +a_n(x-a)^n}_{\text{partie polynômiale}}+o_a((x-a)^n)
    \]
\end{dfn}

\begin{rem}
    Lorsqu'un $\mathrm{DL}_n(a)$ existe, il y a unicité de la partie polynômiale.
\end{rem}

\begin{rem}
    Les DL usuels sont à connaître.

\begin{align*}
    e^x &= 1 + x + \frac{x^2}{2} +\ldots+ \frac{x^n}{n!} &+ o_0(x^n) \\
%              = \sum_{k=0}^n \frac{x^n}{n !} + x^{n+1}\varepsilon(x) \\
    \sin x &= x - \frac{x^3}{3!}+\frac{x^5}{5!} +\ldots+(-1)^p\frac{x^{2p+1}}{(2p+1)!}
           & +o_0(x^{2p+1} ) \\
%              = \sum_{k=0}^p (-1)^p\frac{x^{2p+1}}{(2p+1)!} + x^{2p+2}\varepsilon(x) \\
    \cos x &= 1 - \frac{x^2}{2!}+\frac{x^4}{4!} +\ldots+(-1)^p\frac{x^{2p}}{(2p)!}
           & +o_0(x^{2p}) \\
    \frac{1}{1-x} &= 1 + x + x^2 + + x^3 + \ldots + x^n
        & + o_0(x^n) \\
    \ln (1-x) &= -x - \frac{x^2}{2} - \frac{x^3}{3} - \frac{x^4}{4} - \ldots - \frac{x^n}{n}
        & + o_0(x^n) \\
    (1+x)^\alpha &= 1 + \alpha x + \alpha (\alpha-1) \frac{x^2}{2!} + \ldots \\
        & \qquad\qquad +\alpha(\alpha-1)\ldots(\alpha-n+1)\frac{x^n}{n!}
        & + o_0(x^n) \\
\end{align*}
Les règles de calcul sont aussi à connaître (vues en sup: composition, troncature, multiplication)
\end{rem}

\begin{dfn}[Voisinage\index{voisinage}]
    Un voisinage de $a\in\mathbb R$ est un intervalle du type $]a-\varepsilon, a+\varepsilon[$. Si $V$ est un voisinage de $a$, on note $V\in\mathcal V(a)$.
\end{dfn}

Si $V\in\mathcal V(0)$ et si pour $x\in V\setminus\{0\}$, $f(x)=a_0+a_1x +a_px^p+o_p(x^p)$, $a_p\neq 0$ et $p\geq 2$ alors \begin{itemize}
    \item $f$ est prolongeable en $0$ et $f(0)=a_0$
    \item $f$ est dérivable en $0$ et $f'(0)=a_1$
    \item $y=a_0+a_1x$ est l'équation cartésienne de la tangente au graphe de $f$ en $0$
    \item $f(x)-a_0-a_1x$ a le même signe que $a_px^p$ au voisinage de $0$.
\end{itemize}

\begin{rem}
    $f$ admet un $\mathrm{DL}_1(a)$ si et seulement si $f$ est dérivable en $a$. Ça n'est pas vrai pour les ordres supérieurs de dérivation.
\end{rem}

\begin{ex}
    On pose \[
        f: x\in]-\pi;\pi[\setminus\{0\} \longmapsto \frac 1x-\frac1{\sin x}
    \]
    et on a (en utilisant les DL usuels et les règles de calcul) \[
        \forall x\in D_f,\quad f(x)=\frac1x-\frac1{x-\frac{x^3}3+o_0(x^3)}=\frac1x \left( 1- \left( 1+\frac {x^2}6+o_0(x^2) \right)\right)=-\frac16x+o_0(x)
    \]
    donc $f$ est prolongeable en $0$ avec $f(0)=0$, $f'(0)=-\frac 16$.

    La fonction $f$ est $\mathcal C^1$ sur son domaine de définition, l'est-elle en $0$ ? On a \[
        \forall x\in D_f, \qquad f'(x)=-\frac1{x^2}+\frac{\cos x}{\sin^2x}=\frac1{x^2} \left( -1+\frac{1-\frac{x^2}2+o_0(x^2)}{(1-\frac{x^2}6+o_0(x^2))^2} \right)=-\frac16+o_0(1)\xrightarrow[x\to 0]{}-\frac16
    \]
    donc $f$ est $\mathcal C^1$ en $0$
\end{ex}

\section{Taylor-Young}

\begin{thm}[Taylor-Young\index{Taylor-Young (théorème de -- )}]
    \Hyp $f\in\mathcal C^n(V\in\mathcal V(0), \mathbb R)$
    \Conc \[
            \forall x\in V, \qquad f(x)=\sum_{k=0}^n\frac{f^{(k)}(0)}{k!}x^k+o_0(x^n)
    \]
\end{thm}

\begin{rem}
    On n'a en fait besoin que de $f\in\mathcal C^{n-1}(V, \mathbb R)$ et $f^{(n-1)}$ dérivable en $0$
\end{rem}

\begin{rem}
    On ne peut en général pas dériver termes à termes. Si $f$ est $\mathcal C^n$, on peut dériver termes à termes pour obtenir le $\mathrm{DL}_{n-1}(0)$ de $f'$.
\end{rem}

\begin{ex}[$a$]
    Pour obtenir un $\mathrm{DL}_3(1)$ de $\arctan$, on note $f=\arctan$ et \[
        f(1)=\frac\pi4\qquad f'(1)=\frac12\qquad f''(1)=-\frac12\qquad f^{(3)}(1)=\frac1{2}
    \]
    donc \[
        \forall x\in \left]-\frac\pi2;\frac\pi2  \right[, \qquad f(x)=\frac\pi4+\frac{x-1}2-\frac{(x-1)^2}4+\frac{(x-1)^3}{12}+o_1((x-1)^3)
    \]
\end{ex}

\begin{ex}[$b$]
    On note $f\in\mathcal C^{\infty}([-1; 1], \mathbb R)$ telle que $\forall n\in\mathbb N^\star$, \begin{align*}
        f \left( \frac1n \right) &= \frac{\sqrt n}{\sqrt{n+1}+\sqrt n}\\
                                 &= \frac1{1+\sqrt{1+\frac1n}}\\
                                 &= \frac{\sqrt{1+\frac1n}-1}{\frac 1n}\\
                                 &= n \left( \sum_{k=1}^{2020}\binom {1/2}{k}\frac1{n^k}+o_{+\infty}(\frac{1}{n^{2020}}) \right) \\
                                 &= \sum_{k=0}^{2019}\frac{f^{(k)}(0)}{k!}\frac1{n^k}+o_{+\infty}(\frac1{n^{2019}})
    \end{align*}
    Puis $n\to +\infty$ donne \[
        \binom{1/2}1=f(0)
    \]
    et $nf(1/n)$ avec $n\to+\infty$ donne \[
        \binom{1/2}2=\frac{f'(0)}{1!}
    \]
    et en itérant on obtient \[
        \binom{1/2}{2020}=\frac{f^{(2019)}(0)}{2019!}
    \]
\end{ex}

\section{Utilisation standard des développements limités}

\subsection{Calcul de limite}

On va calculer \[
    \lim_{x\to 0^+}\frac{x^{\sh x}-(\sh x)^x}{(\sin x)^x-x^{\sin x}}
\]
Et on a \[
    \sh x=x+\frac{x^3}6+o_0(x^3)\qquad\qquad \sin x=x-\frac{x^3}6+o_0(x^3)
\]
donc, après calculs, \[
    \frac{x^{\sh x}-(\sh x)^x}{(\sin x)^x-x^{\sin x}} = \frac{\frac{x^3}6\ln x+o_0(x^3\ln x)-\frac{x^3}6+o_0(x^3)}{\frac{-x^3}6+o_0(x^3)+\frac{x^3}6\ln x+o_0(x^3\ln x)}\underset{0+}\sim -1
\]

\subsection{Développement limité d'une réciproque}

\begin{exo}
    Soit $x\in\mathbb R$. Montrer $\exists!\psi(x)\defeq y\in\mathbb R, e^{x+y}+y=1$. Montrer que $\psi$ admet un $\mathrm{DL}_2(0)$ que l'on donnera
\end{exo}

\begin{proof}[Résolution (Idée 1)]
    On étudie $y\longmapsto e^{x+y}+y-1$ à $x$ fixé. Problème: comment trouver un $\mathrm{DL}_2$ en $x$ ?
\end{proof}

\begin{proof}[Résolution (Idée 2)]
    «On perturbe le problème.» \[
        e^{x+y}+y=1\iff e^{x+y}+x+y=1+x \iff \varphi(x+y)=1+x
    \]
    avec $\varphi: t\longmapsto e^t+t\in\mathcal C^{\infty}(\mathbb R, \mathbb R)$ strictement croissante de dérivée jamais nulle. C'est donc une bijection de $\mathbb R$ dans $\mathbb R$ de bijection réciproque dérivable: \[
        \varphi^{-1'}=\frac1{\varphi'\circ \varphi^{-1}}\in\mathcal C^1
    \]
    donc $\varphi^{-1}\in\mathcal C^2$ (en fait $\mathcal C^{\infty}$) donc $\varphi^{-1}$ admet un $\mathrm{DL}_2(a)$ en $a\in\mathbb R$.

    On a $\psi(x)=-x+\varphi^{-1}(1+x)$ donc $\psi$ a un $\mathrm{DL}_2(0)$. Donc on écrit \[
        \psi(x)=a_0+a_1x+a_2x^2+o_0(x^2)
    \]
    et \[\psi(\varphi(x)-1)=-\varphi(x)+1+x=-x-\frac{x^2}2+o_0(x^2)=\psi \left(2x+\frac{x^2}2+o_0(x^2)\right)\]
    donc \[
        -x+\frac{x^2}2+o_0(x^2)=a_0+2a_1x+\left(\frac{a_1}2+4a_2\right)x^2+o_0(x^2)
    \]
    et on identifie les coefficients
\end{proof}

\section{Utilisation non standard des développements limités}

\subsection{Calul de primitive}

On veut calculer une primitive de \[
    F:x\longmapsto \frac1{x^{2019}(1+x^2)}.
\]
On a \[
    F(x)=\sum_{k=0}^{1010}(-1)^kx^{2k-2019}+o_0(x)
\]
donc \[
    F(x)-\sum_{k=0}^{1009}(-1)^kx^{2k-2019}=o_0(1)
\]
est une fraction rationnelle sans partie polaire en $0$, donc \[
    \sum_{k=0}^{1009}(-1)^kx^{2k-2019}
\]
est la partie polaire de $F$ en $0$ et \[
    F(x)=\sum_{k=0}^{1009}(-1)^kx^{2k-2019}+\frac{\alpha x+\beta}{1+x^2}
\]
et en injectant $i$, $\alpha i+\beta=i$ d'où $\alpha=1, \beta=0$. Puis on peut intégrer termes à termes

\subsection{Développement limité d'un terme général}

On note $f$ une fonction $\mathcal C^2$ sur un voisinage $V$ de $0$ telle que $f(0)=0$. On définit pour $n$ suffisament grand, \[
    u_n=\sum_{k=1}^nf\left(\frac{k}{n^2}\right)
\]
On va faire l'étude de $u_n$. \[
    \forall k\in\llbracket 1, n\rrbracket, \quad f \left( \frac{k}{n^2} \right)=\frac{f'(0)k}{n^2}+\frac{f''(0)}{2}\cdot \frac {k^2}{n^4}+\frac {k^2}{n^4}\cdot \varepsilon \left( \frac{k}{n^2} \right), \qquad \qquad \varepsilon (x)\xrightarrow[x\to0]{}0
\]
donc \[
    u_n=\frac{f'(0)}{n^2}\sum_{k=1}^nk+\underbrace{\frac{f''(0)}{2n^4}\sum_{k=1}^nk^2}_{\longrightarrow 0}+\underbrace{\frac1{n^4}\sum_{k=1}^nk^2\varepsilon \left( \frac k{n^2} \right)}_{\longrightarrow 0\text{ car }\varepsilon\text{ bornée }}\xrightarrow[n\to+\infty]{}\frac{f'(0)}2
\]

\subsection{Polynôme sous contrainte}

\begin{exo}
Trouver un polynôme $P_n$ tel que $P_n^2(x)=1+x+o_0(x^n)$. En déduire une racine carrée de \[
    A= \begin{pmatrix}
        4&1\\-9&-2
    \end{pmatrix}
\]
\end{exo}
\begin{proof}
    \[
        P_n=\sum_{k=1}^n\binom{1/2}{k}x^k
    \]
    convient et \[
        A=I_n+ \underbrace{\begin{pmatrix}
            3&1\\-9&-3
    \end{pmatrix}}_{\defeq N},\qquad \qquad N^2=0
    \]
    donc $P_1^2(N)=I_n+N+\frac{N^2}4=I_n+N=A$ donc $P_1(N)$ convient.
\end{proof}

\subsection{Formule combinatoire}

On va montrer que si $0\leq m\leq n$ alors \[
    \sum_{k=0}^n(-1)^{n-k}\binom nkk^m=\delta_{n,m}n!
\]
On écrit \[
    (e^x-1)^n=\sum_{k=0}^n\binom nk (-1)^{n-k}e^{kx}=(x+o(x))^n=x^n+o_0(x^n)
\]
et pour $m<n$, on identifie le coefficient de $x^m$ (il est nul). Sinon, $n=m$ et le résultat est le bon.

\section{Majorer, minorer, encadrer}

\subsection{Rappels}

\[
    |x|\leq a\iff -a\leq x\leq a
\]

\[
    \begin{cases}
        x\leq x'\\ y\leq y'
    \end{cases}
    \implies \begin{cases}
        x+y\leq x'+y'
    \end{cases}
\]
\[
    \begin{cases}
        0\leq x\leq x'\\ 0\leq y\leq y'
    \end{cases}
    \implies xy\leq x'y'
\]
\[
    ||x|-|y||\leq |x+y|\leq |x|+|y|
\]

\subsection{Sommation terme à terme}

Si $a_1\leq b_1, \cdots, a_n\leq b_n$ alors \[
    a_1+\cdots +a_n\leq b_1+\cdots+ b_n
\]
avec égalité ssi $a_1=b_1,\cdots a_n=b_n$. Le résultat se généralise identiquement aux séries convergentes.

\begin{ex}
    pour $n\geq 3$, \[
        \frac1{n^3}\leq \frac1{n(n-1)(n-2)}=\frac1{2n}-\frac1{n-1}+\frac1{2(n-2)}
    \]
    et en sommant, \[
        \zeta(3)=\sum_{k=1}^{+\infty}\frac1{k^3}< \frac{11}8
    \]
\end{ex}

\subsection{Inégalité de Cauchy-Schwarz}

\index{Cauchy-Schwarz (inégalité de -- )}

On va montrer l'inégalité de Cauchy-Schwarz de deux manières différentes


\textbf{Identité de Lagrange.} On note $a_1, \cdots, a_n, b_1, \cdots, b_n\in\mathbb R$. \begin{align*}
        \left( \sum_{i=1}^na_i^2 \right) \cdot \left( \sum_{i=1}^n b_i^2 \right)- \left( \sum_{i=1}^na_ib_i \right)^2 &= \sum_{i=1}^n\sum_{j=1}^n \underbrace{a_i^2b_j^2-a_ib_ia_jb_j}_{=0\text{ si }i=j} \\
                                                                                                                      &= \sum_{i<j}(a_i^2b_j^2+a_j^2b_i^2)-2a_ib_ia_jb_j \\ 
                                                                                                                      &= \sum_{i<j}(a_ib_j-a_jb_i)^2\geq 0
    \end{align*}

\textbf{Utilisation de l'homogénéité.} On suppose les $b_i$ non tous nuls. On pose \[
    f:(a, b)\longrightarrow \left( \sum_{i=1}^na_i^2 \right) \cdot \left( \sum_{i=1}^n b_i^2 \right)- \left( \sum_{i=1}^na_ib_i \right)^2
\]
On a, pour $\lambda, \mu\geq 0$, $f(\lambda a, \mu b)=\lambda^2\mu^2f(a, b)$ de même signe que $f(a, b)$. Il existe $\lambda, \mu\geq 0$ tels que \[
    \sum_{i=1}^n \lambda^2a_i^2=\sum_{j=1}^nb_j^2\mu^2=1
\]
de sorte qu'on peut supposer sans perte de généralité \[
    \sum_{i=1}^na_i^2=\sum_{j=1}^n b_j^2=1
\]
Puis $|a_ib_i|\leq \frac{a_i^2+b_i^2}2$ donc \[
    \sum_{i=1}^n|a_ib_i|\leq \frac{1+1}2=1
\]
d'où \conc

\subsection{Inégalités fonctionnelles}

Montrer que si $0<p<1$ et $\theta\in \left[ 0; \frac\pi2 \right]$ alors \[
    \cos^p\theta\leq \cos(p\theta)
\]
On pose \[
    f_p:\theta\in \left[ 0;\frac\pi2 \right]\longmapsto -\cos^p\theta+\cos(p\theta)
\]
de sorte que \[
    f_p'(\theta)=-p\sin(p\theta)+p\sin\theta\cos^{p-1}\theta
\]
or $\sin(p\theta)\leq \sin\theta\leq \sin\theta\cos^{p-1}\theta$ donc $f_p'(\theta)\geq 0$ et $f_p$ croissante, ce qui conclut puisque $f_p(0)=0$

\subsection{Inégalité de réordonnement}

On note \[
    \begin{cases}
        a_1\leq \cdots \leq a_n\\ b_1\leq \cdots \leq b_n
    \end{cases}
\]
et $\sigma\in\mathfrak S_n$. Puis, on définit \[
    S_\sigma\defeq\sum_{i=1}^na_ib_{\sigma(i)}.
\]
$S_\sigma$ est maximal pour $\sigma=\id$, et minimal pour $\sigma=(n\;\;n-1\;\;\cdots \;\; 1)$. On suppose que $\sigma$ maximise $S_\sigma$. On note $\sigma'=(1\;\;\sigma(1))\circ \sigma$ donc \[ S_{\sigma'}-S_\sigma=a_1b_1+a_{\sigma^{-1}(1)}b_{\sigma(1)}-a_1b_{\sigma(1)}-a_{\sigma^{-1}(1)}b_1 =(a_1-a_{\sigma^{-1}(1)})(b_1-b_{\sigma(1)})\geq 0\]
donc on peut supposer $\sigma(1)=1$. En itérant, $\sigma=\id$ est maximisante. On procède de la même manière pour la permutation minimisante.

\begin{ex}[Application 1]
    On note $f:\mathbb N^\star\to\mathbb N^\star$ bijective. On cherche la nature de $\sum\dfrac1{nf(n)}$.
    On note $a_1<\cdots <a_n$ les éléments $f(1), \cdots, f(n)$ ordonnés. Alors \[
        \sum_{k=1}^n\frac1{kf(k)}\leq \frac1{na_n}+\cdots \frac1{a_1}\leq \frac1{n^2}+\cdots +\frac1{1^2}\leq\zeta(2)
    \]
    donc la série converge.
\end{ex}

\begin{ex}[Inégalité AM-GM]
    On note $x_1, \cdots, x_n\geq 0$, et on note \[
        f(x_1, \cdots, x_n)=\frac1n\sum x_i-\sqrt[n]{\prod x_i}
    \]
    de sorte que $f(\lambda x_1, \cdots, \lambda x_n)=\lambda f(x_1, \cdots, x_n)$ pour $\lambda\geq 0$ donc on peut supposer $\prod x_i=1$. En notant \[
        a_k=\prod_{i=1}^kx_i\qquad\qquad\qquad b_i=\frac1{a_i}
    \]
    on a \[
        n=a_1b_1+\cdots a_nb_n\leq \underbrace{a_1b_n}_{x_1}+\underbrace{a_2b_1}_{x_2}+\cdots + a_nb_{n-1}=x_1+\cdots+x_n
    \]
    ce qui conclut.
\end{ex}

\subsection{Échelles de références}

\begin{dfn}[Rappels]
    Si $f$ et $g$ sont définies sur un voisinage de $a\in\bar{\mathbb R}$ alors \[
        f(x)=o_a(g(x))\iff \exists V'\subset V, V'\in\mathcal V(a), \exists \varepsilon:V'\to\mathbb R, \forall x\in V', f(x)=\varepsilon(x)g(x)\text{ et }\varepsilon(x)\xrightarrow[x\to a]{}0
    \]
    \[
        f(x)=O_a(g(x))\iff \exists M>0, \exists V'\subset V, V\in\mathcal V(a), \forall x\in V', |f(x)|\leq M|g(x)|
    \]
    \[
        f(x)\underset a\sim g(x)\iff f(x)=g(x)+o_a(g(x))
    \]
\end{dfn}

\begin{ex}
    \[ x^\alpha|\ln x|^\beta=o_0(x^{\alpha'}|\ln x|^{\beta'})\iff \alpha>\alpha'\quad \text{ ou }\quad \alpha=\alpha'\text{ et }\beta<\beta'\]
    \[x^\alpha (\ln x)^\beta=o_{+\infty}(x^{\alpha'}(\ln x)^{\beta'})\iff \alpha<\alpha'\quad\text{ ou }\quad \alpha=\alpha'\text{ et }\beta<\beta'\underset{\text{def}}\iff (\alpha, \beta)\prec (\alpha', \beta')\]
\end{ex}

\begin{csq}
    $(x\in\mathbb R_+^\star\longmapsto x^\alpha |\ln x|^\beta)_{\alpha,\beta}$ est une famille libre (pour une famille finie, on ordonne \\$(\alpha_1, \beta_1)\prec~\cdots~\prec~(\alpha_n,\beta_n)$ et on prend la limite en $+\infty$)
\end{csq}

\section{Suites numériques}

\subsection{Caractérisation de la borne supérieure}

\begin{thm}
    \Hyp $\emptyset\neq A\subset\mathbb R$, $M\in\mathbb R$.
    \Conc Il y a équivalence entre \begin{enumerate}[label=(\alph{enumi}),left=1.2cm]
        \item $M=\sup A$
        \item $M$ majore $A$ et $\exists a=(a_n)_n\in A^{\mathbb N}, \quad a_n \longrightarrow M$
    \end{enumerate}
\end{thm}

\begin{proof}
    ~ \begin{enumerate}
        \item $(a\implies b)$ $M$ majore $A$ par définition et pour tout $n$, il existe $a_n\in A$ tel que \[
                M-\frac1n<a_n
            \]
            donc $a_n\longrightarrow M$
        \item $(b\implies a)$ Supposons qu'il existe un majorant $M'<M$ de $A$. Alors toute suite convergente de $A$ a une limite $\ell\leq M'<M$ donc $a_n\longrightarrow M\implies M\leq M'$ absurde. Donc $M$ est le plus petit majorant.
    \end{enumerate}
\end{proof}

\subsection{Limite supérieure et inférieure}

On se donne $u$ une suite réelle bornée. On pose pour $n\in\mathbb N$, \[
    u_n^+=\sup\{u_k, \quad k\geq n\}\qquad \qquad u_n^-=\inf \{u_k,\quad k\geq n\}
\]
de sorte que $u_0^-\leq u_n^-\leq u_n\leq u_n^+\leq u_0^+$ et les deux suites $u^+, u^-$ étant monotones bornées, elles sont convergentes.

\begin{dfn}
    Pour une suite réelle $u$, on appelle limite supérieure et limite inférieure les quantités \[
        \limsup_{n\to+\infty}u_n\defeq\lim_{n\to+\infty}u_n^+\qquad\qquad\qquad\qquad \liminf_{n\to+\infty}u_n\defeq\lim_{n\to+\infty}u_n^-
    \]
\end{dfn}

On va construire une extractice $\varphi$ de la manière suivante: \begin{itemize}
    \item $\varphi(0)=0$. On a $u_1^+-1<u_1^+$ donc $\exists k_1\geq 1, u_1^+-1<u_{k_1}\leq u_1^+$
    \item $\varphi(1)=k_1$. On a $u_2^+-\frac12<u_2^+$ donc $\exists k_2\geq k_1, u_2^+-\frac12<u_{k_2}\leq u_2^+$
    \item $\cdots$
\end{itemize}
On construit ainsi une sous-suite convergente (qui converge vers $\limsup u$).

\begin{rem}
    On a montré le théorème de Bolzano-Weierstrass\index{Bolzano-Weierstrass (théorème de -- )}
\end{rem}

\needspace{5cm}
\subsection{Suites sous-additives}

\begin{res}[Lemme de Fekete, Lemme sous-additif\index{Fekete (lemme de -- )}\index{lemme sous-additif}]
    On dit que $(u_n)_n$ est sous-additive si \[
        \forall n, m\in\mathbb N^\star, u_{n+m}\leq u_n+u_m
    \]
    Dans ce cas, \[
        \frac{u_n}n\xrightarrow[n\to+\infty]{}\inf\left\{\frac{u_k}k, \quad k\geq 1\right\}\defeq\ell
    \]
\end{res}

\begin{proof}
    On suppose $\ell\in\mathbb R$ (le cas $\ell=-\infty$ se traite similairement).

    On note $\varepsilon>0$. Il existe $k_0\in\mathbb N^\star$ tel que \[
        \ell\leq \frac{u_{k_0}}{k_0}\leq \ell+\varepsilon'\defeq\ell+\frac\varepsilon2
    \]
    Pour $n\in\mathbb N$$\star$, on écrit $n=pk_0+r$ la division euclidienne de $n$ par $k_0$. Alors, \[
        u_n\leq pu_{k_0}+u_r\implies \frac{u_n}n\leq \frac{u_{k_0}}{k_0}+\frac{u_{r_0}}n\leq \ell+\varepsilon'+\frac{u_{r_0}}n\xrightarrow[n\to+\infty]{}\ell+\varepsilon'
    \]
    donc à partir d'un certain rang, \[
        \ell\leq \frac{u_n}n\leq \ell+2\varepsilon'=\ell+\varepsilon
    \]
    de sorte que \[
        \frac{u_n}n\xrightarrow[n\to+\infty]{}\ell
    \]
\end{proof}

\begin{ex}[Application aux chemins auto-évitants]
    On munit $\mathbb Z^2$ de l'ensemble d'arêtes \[\{\{(a, b), (a+\epsilon, b+(1-\epsilon))\}, \quad \epsilon\in\{0,1\}, a,b\in\mathbb Z \}\] de sorte à obtenir un graphe sommet-transitif\footnote{chaque sommet joue le même rôle: entre chaque sommets, il existe un automorphisme de graphe qui envoie l'un sur l'autre} qui correspond au réseau «classique» $\mathbb Z^2$. On note ce graphe $G$, et la transitivité permet d'en choisir arbitrairement un sommet $O$ qui sera l'origine des chemins. Un chemin auto-évitant sur $G$ de taille $n$ est un chemin sur $G$ (suite de sommets adjacents qui commence par l'origine $O$) de longueur $n$ qui ne passe pas deux fois par le même sommet. On note $c_n$ le nombre de chemins auto-évitants de longueur $n$.

    On a clairement $c_{n+m}\leq c_nc_m$ (car un chemin de longueur $n+m$ est la juxtaposition d'un chemin de longueur $n$ et un autre de longueur $m$), de sorte que $(\ln c_n)_n$ est sous-additive positive. On a donc \[
        \frac1n\ln c_n\xrightarrow[n\to+\infty]{}\ell=\ln\mu
    \]
    donc \[
        c_n^{1/n}\xrightarrow[n\to+\infty]{}\mu
    \]
    Cette limite $\mu$ est appelée \emph{constante de connectivité\index{constante de connectivité}} de $G$. Le raisonnement que l'on vient de mener montre que tout graphe sommet-transitif admet une constante de connectivité.
\end{ex}

\begin{ex}[Application aux quasi-morphismes de $\mathbb Z$]
    On dit que \[
        f:\mathbb Z\longrightarrow\mathbb R
    \]
    est un quasi-morphisme s'il existe $C>0$ tel que \[
        \forall m,n\in\mathbb Z, \quad |f(n+m)-f(n)-f(m)|\leq C
    \]
    On va montrer par récurrence $|f(n_1+\cdots +n_p)-f(n_1)-\cdots -f(n_p)\leq pC$
    \begin{itemize}
        \item Pour $p=1$, c'est vrai.
        \item On suppose que c'est vrai pour $p$. \begin{align*}
                |f(n_1+\cdots +n_{p+1})&-f(n_1)-\cdots f(n_{p+1})|\\ &\leq |f(n_1+\cdots+n_{p})-f(n_1)-\cdots-f(n_p)|\\&\phantom{\leq }+|f(n_1+\cdots+n_{p+1})-f(n_1+\cdots +n_p)-f(n_{p+1})|\\&\leq (p+1)C
            \end{align*}
    \end{itemize}
    On a alors \[
        |f(pn)-pf(n)|\leq pC\qquad \qquad |f(pn)-nf(p)|\leq nC
    \]
    donc \[
        \left| \frac{f(pn)}{pn}-\frac{f(n)}n \right|\leq \frac Cn\qquad \qquad \left| \frac{f(pn)}{pn}-\frac{f(p)}p \right|\leq \frac Cp
    \]
    donc \[
        \left| \frac{f(n)}n-\frac{f(p)}p \right|\leq \frac Cn+\frac Cp
    \]
    On note \[
        u_n=\frac{f(2^n)}{2^n}
    \]
    de sorte que $|u_{n+1}-u_n|$ est le terme général d'une série convergente, donc $(u_n)$ converge vers un réel $\ell$. Puis \[
        \Big| \frac{f(n)}n-\underbrace{u_n}_{\longrightarrow \ell} \Big|\leq \frac Cn+\frac C{2^n}\xrightarrow[n\to+\infty]{}0
    \]
    donc \[
        \frac {f(n)}n\xrightarrow[n\to+\infty]{}\ell
    \]
\end{ex}

\begin{exo}[Application aux quasi-morphismes réels]
    Soit $f:\mathbb R\longrightarrow \mathbb R$ un quasi-morphisme. \begin{enumerate}
        \item Montrer qu'il existe un morphisme $\varphi$ tel que $\forall x\in\mathbb R, |f(x)-\varphi(x)|\leq C$
        \item Montrer que si $f$ est continue, $\varphi$ est linéaire.
    \end{enumerate}
\end{exo}

\section{Parties entières}

\begin{dfn}
    Soit $x\in\mathbb R$. On appelle \textbf{partie entière\index{partie entière}} de $x$ l'unique entier $p$ tel que \[
        p\leq x<p+1
    \]
    On la note $E(x)$ ou $\floor x$
\end{dfn}

\begin{csq}
    \[
        \left| x-\frac{\floor {10^px}}{10^p} \right|\leq \frac1{10^p}\xrightarrow[p\to+\infty]{}0
    \]
    donc $\mathbb Q$ dense dans $\mathbb R$
\end{csq}

\begin{ex}[Approximation d'un irrationnel]
    On note $\alpha\in\mathbb R_+\setminus\mathbb Q$, et $ \left( \dfrac{p_n}{q_n} \right)_n$ une suite de rationnels qui converge vers $\alpha$. Que dire de $(p_n)_n$ et $ (q_n)_n$ ?

    Pour $N\in\mathbb N^\star$, on note $I_N=\{k\alpha, k\in\llbracket1 ,N\rrbracket\}$. On note $d$ un entier naturel qui minimise la distance à $I_N$. Cette distance (notée $d(I_n, \mathbb Z)$) est $>0$ car $I_N$ ne contient que des irrationnels. À partir d'un certain rang, \[
        \left| \alpha-\frac{p_n}{q_n} \right|<\frac{d(I_N, \mathbb Z)}N \iff |q_n\alpha-p_n|<\frac{d(I_n, \mathbb Z)}N q_n
    \]
    Donc $q_n\not\in\llbracket1,N\rrbracket$ donc $q_n>N$ d'où \[
        q_n\xrightarrow{}+\infty
    \]
    et \[
        p_n\underset{+\infty}\sim\alpha q_n\xrightarrow{}+\infty
    \]
\end{ex}

\section{Suites récurrentes doubles et déterminant tridiagonal}

On note \[
    \Delta_n= \begin{vmatrix}
        a   & c      &        & (0) \\
        b   & \ddots & \ddots & \\
            & \ddots & \ddots & c\\
        (0) &        & b      & a
    \end{vmatrix}
\]
Après calculs, pour $n\geq3$, \[
    \Delta_n=a\Delta_{n-1}-bc\Delta_{n-2}.
\]

\begin{ex}
    Si $a=b=-c=1$, alors $\Delta_n=Ar_+^n+Br_-^n$ avec $r_+, r_-$ solutions de $r^2=r+1$ et \[
        A=\frac{ \begin{vmatrix}
                1 & 1 \\ 1 & r_-
        \end{vmatrix} }{r_--r_+} \qquad \qquad \qquad B=\frac{ \begin{vmatrix}
                1 & 1 \\ r_+ & 1
        \end{vmatrix} }{r_--r_+}.
    \]
\end{ex}

\begin{exo}
    Montrer que si $a=2\cos\theta$ et $b=c=1$ alors pour $\theta\not\in\pi\mathbb Z$, \[
        \Delta_n=\frac{\sin((n+1)\theta)}{\sin\theta}.
    \]
\end{exo}

\section{Développements asymptotiques -- Équivalents}

\subsection{Développement asymptotique d'une suite implicite}

\begin{exo}
    Montrer qu'il existe un unique $u_n\in[0, 1]$ tel que $u_n^5+nu_n-1=0$. En donner un DA à deux termes.
\end{exo}

\begin{proof}[Résolution.]
    L'existence et l'unicité sont faciles. On a \[
        u_n=\frac1n-\frac{u_n^5}n\xrightarrow[n\to+\infty]{}0
    \]
    puis \[
        \frac{u_n^5}n=o \left( \frac1n \right)\implies u_n\underset{+\infty}\sim\frac1n
    \]
    donc \[
        u_n=\frac1n-\frac{ \left( \frac1n+o\left(\frac1n\right) \right)^5 }n=\frac1n-\frac1{n^6}+o \left( \frac1{n^6} \right)
    \]
\end{proof}

\subsection{Développement asymptotique d'une fonction implicite}

\begin{exo}
    Montrer que pour $x\in\mathbb R$, il existe un unique $y>0$ tel que $\dfrac y{\ln y}=x$. On le note $\psi(x)$. Donne un DA en $+\infty$ de $\psi$
\end{exo}

\begin{proof}[Résolution]
    L'unicité et l'existence sont faciles. On a \[
        \psi(x)=x\ln \psi(x) \geq x \implies \psi(x)\xrightarrow[x\to+\infty]{}+\infty
    \]
    et \[
        \ln\psi(x)=\ln x+\ln(\ln \psi(x))=\ln x+o_{+\infty}(\ln \psi(x))\sim \ln x
    \]
    donc \[
        x\ln \psi(x)=\psi(x)\sim x\ln x
    \]
    puis \[
        \psi(x)=x\ln\psi(x)=x\ln(x\ln x\cdot(1+o(1)))=x\ln x+x\ln(\ln x)+x\ln(1+o(1))
    \]
\end{proof}

\begin{rem}
    Si on note $\pi$ la fonction qui compte les nombres premiers: $\pi:n\longmapsto \#\mathbb P\cap\llbracket1,n\rrbracket$, alors on admet (difficile) le théorème des nombres premiers: \[
        \pi(n)\underset{+\infty}\sim \frac n{\ln n}
    \]
    d'où \[
    p_n=n\ln(p_n)(1+o(1))\implies \ln p_n=\ln n+\ln p_n+\ln(1+o(1))\] donc \[ \ln p_n\sim \ln n \implies p_n\sim n\ln p_n\sim n\ln n
    \]
\end{rem}

\section{Cesàro-Stolz}

\begin{thm}[Cesàro-Stolz\index{Cesàro-Stolz (théorème de -- )}]
    \Hyp $(a_n)$ une suite réelle, $(b_n)$ suite réelle strictement croissante strictement positive qui tend vers $+\infty$. On suppose \[
        \frac{a_{n+1}-a_n}{b_{n+1}-b_n}\xrightarrow[n\to+\infty]{}\ell\in\bar{\mathbb R}
    \]
    \Conc \[
        \frac{a_n}{b_n}\xrightarrow[n\to+\infty]{}\ell
    \]
\end{thm}

\begin{proof}
    On va montrer le cas $\ell\in\mathbb R$. Soit $\varepsilon>0$. À partir d'un certain rang $N$, \[
        \left(\ell-\frac\varepsilon2\right)(b_n-b_{n-1})\leq a_n-a_{n-1}\leq \left( \ell+\frac\varepsilon2 \right)(b_n-b_{n-1}).
    \]
    On somme: \[
        \left( \ell-\frac\varepsilon2 \right)(b_n-b_{N-1})\leq a_n-a_{N-1}\leq \left( \ell+\frac\varepsilon2 \right)(b_n-b_{N-1})
    \]
    d'où \[
        \underbrace{\frac{a_{N-1}}{b_n}}_{\to \; 0}+ \left( \ell-\frac\varepsilon2 \right)\underbrace{\frac{b_n-b_{N-1}}{b_n}}_{\to\;1}\leq \frac{a_n}{b_n}\leq \left( \ell+\frac\varepsilon2 \right)\underbrace{\frac{b_n-b_{N-1}}{b_n}}_{\to\;1}+\underbrace{\frac{a_{N-1}}{b_n}}_{\to\;0}
    \]
    et en passant à la limite, \[
        \frac{a_n}{b_n}\xrightarrow[n\to+\infty]{}\ell
    \]
\end{proof}

\begin{rem}
    Le cas particulier \[
        u_n=\sum_{k=1}^nx_k
    \]
    et $b_n=1$ donne le théorème de Cesàro\index{Cesàro (théorème de -- )}.
\end{rem}

\begin{rem}[Lemme de l'escalier]
    \index{lemme de l'escalier}
    Avec $b_n=n$, on trouve \[
        a_{n+1}-a_n\longrightarrow \ell\in\mathbb R^\star\implies a_n\underset{+\infty}\sim n\ell
    \]
\end{rem}

\endchapter
