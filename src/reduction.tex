\ifsolo
    ~

    \vspace{1cm}

    \begin{center}
        \textbf{\LARGE Réduction des endomorphismes} \\[1em]
    \end{center}
    \tableofcontents
\else
    \chapter{Réduction des endomorphismes}

    \minitoc
\fi
\thispagestyle{empty}

\ifsolo \newpage \setcounter{page}{1} \fi

Dans tout le chapitre, on note $\K$ un corps.

\section{Rappels sur les polynômes}

\begin{thm}
    \Hyp $A, B\in \K[X]$, $B\neq 0$
    \Conc Il existe un unique couple de polynômes $(Q, R)$ dans $\K[X]$ tels que \[
        A=QB+R
    \]
    et $\deg R<\deg B$
\end{thm}

\begin{thmdef}
    $a\in\K$ est une racine de $P$ si et seulement si \[
    P(a)=0\iff (X-a)\;|\;P
\]
et $a$ est racine de multiplicité $\alpha \geq 1$ si et seulement si \[
    \begin{cases}
        P(a)=P'(a)=\cdots=P^{(\alpha - 1)}(a)=0 \\
        P^{(\alpha)}(a)\neq 0
    \end{cases}
    \iff \begin{cases}
        (X-a)^\alpha \; |\; P\\
        (X-a)^{\alpha+1}\;\not|\;P
    \end{cases}
\]
Si $a$ n'est pas racine de $P$, on convient que $a$ est racine de multiplicité $0$.
\end{thmdef}

\begin{thm}[Interpolation de Lagrange]
    \index{Lagrange!interpolation} Pour $a_1, \cdots, a_n\in\R$ des abscisses distinctes et $b_1, \cdots, b_n\in\R$ des ordonnées distinctes, il existe un unique polynôme de degré au plus $n-1$ tel que \[
        \forall i\in\llbracket 1, n\rrbracket, \qquad P(a_i)=b_i
    \]
\end{thm}
\begin{proof}
    \[
        \varphi:P\in\K_{n-1}[X]\longmapsto (P(a_1), \cdots, P(a_n))\in\R^n
    \]
    est un isomorphisme.
\end{proof}

\section{Idéaux de \texorpdfstring{$\K[X]$}{K[X]} et arithmétique}

\begin{thm}
    $\K[X]$ est principal
\end{thm}
\begin{proof}
    C'est un anneau euclidien donc principal (cf. chapitre \textbf{Algèbre générale})
\end{proof}

\begin{thmdef}
    \begin{enumerate}
        \item Il existe un unique polynôme unitaire $Q$ tel que $P\K[X]+Q\K[X]=Q\K[X]$. C'est le PGCD de $A$ et $B$. Deux polynômes sont premiers entre eux si leur PGCD vaut $1$.
        \item Il existe un unique polynôme unitaire $Q$ tel que $P\K[X]\cap Q\K[X]=Q\K[X]$. C'est le PPCM de $A$ et $B$.
        \item (Gauss) \index{Gauss!lemme (polynômial)} Si $A$ et $B$ sont premiers entre eux et $A\;|\;BC$ alors $A\;|\;C$
        \item (Bézout) \index{Bézout (théorème de -- )} $A$ et $B$ sont premiers entre eux si et seulement si il existe $U, V$ tels que $AU+BV=1$.
    \end{enumerate}
\end{thmdef}

\begin{ex}
    $(X^n-1)\land (X^m-1)=X^{n\land m}-1$
\end{ex}

\section{Décomposition en facteurs irréductibles}

\begin{dfn}
    Un anneau $A$ est factoriel si \begin{enumerate}
        \item Pour tout $a\in A$, il existe des éléments irréductibles $p_1, \cdots, p_n$ tels que $a=p_1\cdots p_n$
        \item Cette décomposition est unique à l'ordre des facteurs près et à association près (deux éléments $a$ et $b$ sont associés si il existe un inversible $u$ tel que $a=ub$)
    \end{enumerate}
\end{dfn}

\begin{thm}
    $\K[X]$ est un anneau factoriel
\end{thm}

\begin{ex}
    Dans $\C[X]$, \begin{itemize}
        \item \[
                X^n-1=\prod_{\omega\in\mathbb U_n}(X-\omega)
            \]
        \item \[
                X^{2m}-1=(X+1)(X-1)\prod_{k=1}^{n-1} \left( X-\exp \left( \frac{ik\pi}n \right) \right) \left( X-\exp \left( -\frac{ik\pi}n \right) \right)
            \]
    \end{itemize}
\end{ex}

\begin{exo} Montrer que
    \begin{itemize}
        \item $P(\R)\subset \R_+ \iff \exists A, B\in\R[X], P=A^2+B^2$
        \item $P(\R_+)\subset \R_+\iff \exists A, B\in\R[X], P=A^2+XB^2$
    \end{itemize}
\end{exo}

\begin{proof}[Résolution]
    Éléments de résolution pour le premier point: l'ensemble des $A^2+B^2$ est stable par produit, et en décomposant $P\geq 0$ en facteurs irréductibles, chacun des facteurs est somme de deux carrés.
\end{proof}

\begin{exo}
    $P$ unitaire de degré $n$ dans $\R[X]$. Montrer \[
        P\text{ scindé dans }\R[X] \iff \forall z\in\C, \quad |P(z)|\geq |\mathfrak{Im}(z)|^n
    \]
\end{exo}

\begin{proof}~
    \begin{itemize}
        \item $(\impliedby)$ $P$ scindé dans $\C$ de racines $(a_i)$. $0=|P(a_i)|\geq |\mathfrak{Im}(z)|^n$ donc $a_i\in\R$
        \item $(\implies)$ \[
                \left| P(x+iy) \right|= \left| \prod_{j=1}^n(x-a_j+iy) \right|=\prod_{j=1}^n|x-a_j+iy|\geq \|\mathfrak{Im}(z)|^n
            \]
    \end{itemize}
\end{proof}


\section{Polynômes d'endomorphismes}

\begin{defprop}
    \Hyp On note $E$ un $\K$-e.v., $u\in\mathcal L(E)$ et \[
        P=\sum_{k=0}^{+\infty}a_kX^k\in\K[X]
    \]
    \begin{concenum}
    \item ~ \[
            P(u)\defeq\sum_{k=0}^{+\infty} a_ku^k
        \]
    \item $\varphi: P\in\K[X]\longmapsto P(u)\in\mathcal L(E)$ est un morphisme d'algèbres.
    \end{concenum}
\end{defprop}

\begin{proof}
    On justifie $(PQ)(u)=P(u)\circ Q(u)$. On considère \[
        \psi: (P, Q)\in\K[X]^2\longmapsto (PQ)(u)-P(u)\circ Q(u)\in\mathcal L(u)
    \]
    \begin{itemize}
        \item $\psi$ est bilinéaire
        \item À $Q$ fixé, $P\longmapsto \psi(P, Q)$ AL nulle si et seulement si $\forall j\in\N, \psi(X^j, Q)=0$
        \item Pour chaque $j$, $Q\longmapsto \psi(X^j, Q)$ nulle si et seulement si $\forall k\in\N, \psi(X^j, X^k)=0$ qui est vrai.
    \end{itemize}
\end{proof}

\begin{dfn}
    Un polynôme $P$ est dit \textbf{polynôme annulateur\index{polynôme!annulateur}} de $u\in\mathcal L(E)$ si $P(u)$ est l'application nulle
\end{dfn}

\begin{ex}
    $p$ est un projecteur si et seulement si $X^2-X$ est annulateur. $s$ est une symétrie si et seulement si $X^2-1$ est annulateur
\end{ex}

\begin{defprop}
    L'ensemble des polynômes annulateurs d'un endomorphisme $u$ est un idéal. Il possède un unique générateur unitaire, qu'on appelle \textbf{polynôme minimal\index{polynôme!minimal}}, qu'on notera $\mu_u$ ou $\Pi_u$
\end{defprop}

\begin{proof}
    $(\id, u, \cdots, u^{n^2})$ famille liée de $\mathcal L(E)$ donc l'idéal n'est pas trivial
\end{proof}

\begin{prop}
    $\K[u]\defeq \{P(u), P\in\K[X]\}$ est une $\K$-algèbre de dimension $\deg \mu_u$ de base $(1, u, \cdots, u^{\deg \mu_u-1})$
\end{prop}

\begin{ex}
    $P=X^2-3X+2$ polynôme minimal \[
        A= \begin{pmatrix}
            -2 & -6 \\ 2 & 5
        \end{pmatrix}
    \]
    Puis $X^n=\mu_A\times Q+\alpha_n X+\beta_n$. En injectant $1$ et $2$ (les racines de $\mu_A$) on peut exprimer $\alpha_n$ et $\beta_n$ et $A^n=\alpha_nA+\beta_n$
\end{ex}

\section{Théorème de décomposition des noyaux}

\begin{thm}[Décomposition des noyaux\index{décomposition des noyaux (théorème)}]
    \Hyp $E$ un $\K$-e.v., $u\in\mathcal L(E)$
    \begin{concenum}
    \item Si $P, Q\in\K[X]$ sont premiers entre eux, alors $\Ker (PQ)(u)=\Ker P(u)\oplus \Ker Q(u)$. En particulier, si $PQ$ est annulateur alors $\Ker(PQ)(u)=E$
    \item Si $P_1, \cdots, P_q\in\K[X]$ deux à deux premiers entre eux et si $P=P_1\cdots P_q$ alors \[
            \Ker P(u)=\Ker P_1(u)\oplus\cdots\oplus \Ker P_q(u)
        \]
    \item Dans ce cas, si $Q_i=\frac P{P_i}$, \begin{enumerate}
        \item Il existe $U_1, \cdots, U_q$ tels que $U_1Q_1+\cdots +U_qQ_q=1$
        \item $(U_iQ_i)(u)$ est la projection sur $\Ker P_i(u)$ associée à la décomposition
    \end{enumerate}
    \end{concenum}
\end{thm}

\begin{proof}~
    \begin{enumerate}
        \item On écrit $UP+QV=1$ et si $x\in\Ker P(u)\cap \Ker Q(u)$ alors $(UP+QV)(u)(x)=0=\id(x)=x$ donc la somme est directe

            Puis, la valeur de la somme est la bonne car $\Ker P(u),\Ker Q(u)\subseteq \Ker PQ(u)$ et pour $x\in \Ker PQ(u)$, $x=UP(u)(x)+VQ(u)(x)\in \Ker Q(u)+\Ker P(u)$
        \item Par récurrence, c'est vrai
        \item Les $Q_i$ sont premiers entre eux dans leur ensemble, donc Bézout donne (a). Puis, pour $x$ dans $\Ker P(u)$, \[
                x= \underbrace{U_1Q_1(u)(x)}_{\in\Ker P_1(u)}+\cdots +\underbrace{U_qQ_q(u)(x)}_{\in\Ker P_q(u)}
            \]
            et la somme est directe ce qui conclut.
    \end{enumerate}
\end{proof}

\begin{ex}
    Si $u^3+u=0$, alors $E=\Ker u\oplus \Ker(u^2+\id)$ or $\Ker(u^2+\id)\subset \Img u$ donc $E=\Ker u+\Img u$
\end{ex}

\begin{ex}
    $E$ de dimension finie, $u$ un endomorphisme de $E$ tel que $u\in\Vect(u^k, k\geq 2)$. Il y a donc un polynôme annulateur pour $u$. De même que précédemment, \[
        E=\Ker u\oplus \Img u
    \]
\end{ex}

\begin{ex}
    On note $E$ l'ensemble des suites $(u_n)$ telles que $\forall n\in\N, u_{n+3}=4u_{n+2}-5u_{n+1}+2u_n$. On note $T$ l'endomorphisme $(u_n)_n\longmapsto (u_{n+1})_n$ de sorte que \[
        E=\Ker(T^3-4T^2+5T-2\id)=\Ker((T-\id)^2)\oplus \Ker(T-2\id)
    \]
    et $\Ker(T-2\id)=\{\lambda (2^n)_n, \lambda\in\R\}$, $\Ker(T-\id)=\{(\lambda)_n, \lambda\in\R\}$ puis \[
        u\in \Ker((T-\id)^2)\iff T(u)-u\in\Ker(T-\id)\iff (u_{n+1}-u_n)_n=(\lambda)_n
    \]
    donc $\Ker((T-\id)^2)=\{(\nu+n\mu)_n, \nu, \mu\in\R\}$
\end{ex}

\section{Valeurs propres, vecteurs propres}

\begin{dfn}
    Pour $E$ un $\K$-e.v. et $u$ endomorphisme de $E$, \begin{enumerate}
        \item On dira que $\lambda\in\K$ est \textbf{valeur propre\index{valeur propre}} de $u$ si $\Ker(u-\lambda\id)\neq \{0\}$
        \item On dira que $x\in E$ est un \textbf{vecteur propre\index{vecteur propre}} associé à la valeur propre $\lambda$ si $x\in\Ker(u-\lambda\id)\setminus\{0\}$
        \item L'ensemble des valeurs propres (appelé \textbf{spectre\index{spectre}}) est noté $\Sp_{\K}(u)$ ou simplement $\Sp(u)$.
        \item L'ensemble des vecteurs propres pour la valeur propre $\lambda$ (on compte le vecteur nul pour garder la structure d'e.v.) est noté $E_\lambda=\Ker(u-\lambda \id)$ et s'appelle \textbf{sous-espace propre\index{sous-espace propre}} de $u$ pour $\lambda$.
    \end{enumerate}
\end{dfn}

\subsection{Étude du spectre}

\begin{prop}
    \Hyp $u, v\in\mathcal L(E)$, $P\in\K[X]$ et $\lambda\in\K$
    \begin{concenum}
    \item Si $u$ et $v$ commutent, alors $\Ker u$ et $\Img u$ sont stables par $v$. De même, $E_\lambda(u)$ est stable par $v$.
    \item Si $x\in E_\lambda(u)$, $P(u)(x)=P(\lambda)x$
    \item $P(\lambda)\in\Sp_{\K}(P(u))$ pour $\lambda\in \Sp_{\K}(u)$
    \item Si $P$ est annulateur alors $\Sp_{\K}(u)\subseteq \mathcal Z_{\K}(P)$
    \item $\Sp_{\K}(u)=\mathcal Z_{\K}(\mu_u)$
    \end{concenum}
\end{prop}

\begin{proof}~ \begin{enumerate}
    \item 2. 3. Ok
    \setcounter{enumi}{3}
    \item $P(u)(x)=P(\lambda)x$ pour $x$ vecteur propre $\implies P(\lambda) = 0$ pour $P$ annulateur
    \item On a une inclusion par 4.

        Si $\lambda$ racine de $\mu_u$ dans $\K$ alors \[ \lambda \not\in\Sp(u)\implies u-\lambda\id \in \mathrm{GL}(E)
        \]
        donc dans ce cas $\mu_u=(X-\lambda) Q$ et $Q(u)=0$ absurde par minimalité de $\mu_u$. Donc $\lambda\in\Sp(u)$
\end{enumerate}
\end{proof}

\subsection{Polynôme caractéristique}

\index{polynôme!caractéristique}

\begin{thmdef}
    \Hyp $u\in\mathcal L(E)$ avec $E$ un $\K$-e.v. de dimension $n$, muni d'une base $\mathcal B$. $\mathcal M_{\mathcal B}(u)\defeq A$
    \begin{concenum}
        \item Il y a équivalence entre \begin{enumerate}
            \item $\lambda\in\Sp_{\K}(u)$
            \item $\det(\lambda\id-u)=0$
            \item $\det(\lambda I_n-A)=0$
        \end{enumerate}
        \item Le polynôme $\chi_A=\chi_u$ donné par $\det(X\id -u)=\det(X I_n-A)$ est appelé \textbf{polynôme caractéristique} de $A$ (ou de $u$)
        \item $\chi_A$ est unitaire de degré $n$ et \[
                \chi_A=X^n-\Tr (A) X^{n-1}+\cdots +(-1)^n\det A
            \]
        \item  $\Sp_{\K}(u)=\mathcal Z_{\K}(\chi_u)$
    \end{concenum}
\end{thmdef}

\begin{proof}
    \begin{enumerate}
        \item 2. Ok
        \setcounter{enumi}{2}
    \item Le polynôme est unitaire de degré $n$ car la seule permutation qui donne un coefficient de degré $n$ dans la formule du déterminant est l'identité, et ce coefficient vaut $1$. Toutes les autres permutations ne donnent que des coefficients de degré $<n-1$ donc le coefficient de $X^{n-1}$ ne peut venir que du développement du produit de la diagonale ($\sigma=\id$), dont le coefficient en $X^{n-1}$ vaut bien la trace. Pour le terme constant, on injecte $0$ et par définition on obtient $\det(-A)=(-1)^n\det A$
    \item \[
            \lambda\in\Sp(u)\iff \det(\lambda \id -u)=0\iff \lambda\in\mathcal Z_{\K}(\chi_u)
        \]
    \end{enumerate}
\end{proof}

\begin{ex}[Cas d'une matrice compagnon] On note \[
    A= \begin{pmatrix}
0 & 0 & \dots & 0 & -a_0 \\
1 & 0 & \dots & 0 & -a_1 \\
0 & 1 & \dots & 0 & -a_2 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 & \dots & 1 & -a_{p} \\
\end{pmatrix}\in \mathcal M_{p+1}(\K)
\]
Le calcul de $\det(XI_n-A)$ donne $\chi_A=X^{p+1}+P(X)$ avec $P(X)=a_pX^p+\cdots +a_0$
\end{ex}

\subsection{Théorème de Cayley-Hamilton}

\begin{thm}[Cayley-Hamilton\index{Cayley-Hamilton (théorème de -- )}]
    \Hyp $E$ de dimension finie $n$ et $u\in\mathcal L(E)$
    \Conc $\chi_u$ est annulateur de $u$.
\end{thm}

\begin{proof} (Hors-Programme)

    On note $A$ canoniquement associée à $u$, et $B=XI_n-A$. On a \[
        B\Com(B)^\top = \det(B)I_n=\chi_A(X)I_n
    \]
    $\Com(B)^\top$ a des coefficients dans $\K_{n-1}[X]$ donc il existe des matrices $B_0, \cdots, B_{n-1}$ telles que \[
        \Com(B)^\top=X^{n-1}B_{n-1}+\cdots +B_0.
    \]
    Alors, \begin{align*}
        B\Com(B)^\top&=(XI_n-A)(X^{n-1}B_{n-1}+\cdots +B_0)\\
                     &=X^nB_{n-1}+X^{n-1}(B_{n-2}-AB_{n-1})+\cdots + X(B_0-AB_1)-AB_0\\
                     &=\chi_A(X)I_n
    \end{align*}
    On identifie: \[
        B_{n-1}=I_n\qquad \qquad \qquad \text{ et les autres }B_{i+1}-AB_i\text{ sont de la forme }\alpha_i I_n, \alpha_i\in\R
    \]
    Si on note $\chi_A=X^n+a_{n-1}X^{n-1}+\cdots +a_0$, on a \[
        B_{n-2}-AB_{n-1}=a_{n-1}I_n\quad , \quad \cdots \quad,\quad B_0-AB_1=a_1 I_n\quad,\quad  -AB_0=a_0I_n
    \]
    En remplaçant dans $\chi_A(A)$ tous les termes s'annulent.
\end{proof}

\begin{csq*}~
    \begin{itemize}
        \item Pour $A$ dans $\mathcal M_n(\K)$, $\mu_A\;|\;\chi_A$ donc $\deg \mu_A\leq n$
        \item Si \[
                \chi_A=\prod_{i=1}^r(X-\lambda_i)^{\alpha_i}
            \]
            avec des $\lambda_i$ deux à deux distincts, alors \[
                \mathcal M_n(\K)=\bigoplus_{i=1}^r\Ker\left((A-\lambda_iI_n)^{\alpha_i}\right)
            \]
        \item Si $A$ est nilpotente alors $A^n=0$ car $\deg \mu_A\leq n$
    \end{itemize}
\end{csq*}

\begin{exo}
    $A\in\mathcal M_n(\C)$ non inversible. Montrer qu'il existe $B\in\mathcal M_n(\C)$ non nulle telle que $\forall p\geq 1, (A+B)^p=A^p+B^p$
\end{exo}

\begin{proof}[Éléments de résolution]
    $\mu_A=XP(X)$, $P(A)\neq 0$ par minimalité de $\mu_A$ et $P(A)$ convient.
\end{proof}

\begin{exo}
    Montrer que $A^3+A^2+A+I_n=0\implies \Tr A\leq 0$
\end{exo}
\begin{proof}[Éléments de résolution]
    $P(X)=(X+1)(X^2+1)$ est annulateur donc $\Sp_{\C}(A)\subseteq\{-1, i, -i\}$ et $\chi_A=(X+1)^{\alpha}(X+i)^{\beta}(X-i)^{\gamma}$ polynôme réel donc $\beta=\gamma$ et la trace est le coeff en $X^{n-1}$
\end{proof}

\begin{exo}
    On note $A$ une matrice de $\mathcal M_n(\C)$. Montrer que si $P\in\C[X]$, alors $P(A)$ est inversible si et sulement si $P\land \chi_A=1$ si et seulement si $P\land \mu_A=1$
\end{exo}

\begin{proof}[Résolution]~
    \begin{itemize}
        \item Si $Q$ annulateur tel que $P\land Q=1$, il existe $\exists U, V, \quad UP+QV=1$ donc $U(A)P(A)=I_n$ et $P(A)$ inversible
        \item Si $P(A)$ inversible alors on suppose $\Delta=P\land \chi_A$ non constant divisible par $X-\lambda$ et $P(X)=(X-\lambda)Q(X)$ donc \[
                P(A)=\underbrace{(A-\lambda I_n)}_{\text{non-inversible car }\chi_A(\lambda)=0}Q(A)
            \]
            donc $P(A)$ n'est pas inversible, c'est absurde.
    \end{itemize}
\end{proof}

\begin{exo}
    $A\in\mathrm{GL}_5(\R), \Tr A=2, A^3+A^2-2A=0$. Trouver $\chi_A$
\end{exo}

\begin{proof}[Élément de résolution]
    $A$ inversible donc $X^2+X-2$ annulateur. $\Sp(A)\subset \{1, -2\}$ donc \[\chi_A=(X-1)^\alpha(X+2)^\beta,\] $\alpha+\beta=5$, $\Tr A=\alpha-2\beta=2$ donc $\alpha=4, \beta=1$
\end{proof}

\begin{exo}
    Pour $A, B\in\mathcal M_n(\R)$. Montrer que $\chi_{AB}=\chi_{BA}$
\end{exo}

\begin{proof}[Résolution (Première méthode)]
    \[
        \begin{pmatrix}
            A & -XI_n \\ I_n & 0
        \end{pmatrix} \begin{pmatrix}
            B & -XI_n \\ I_n & -A
        \end{pmatrix}= \begin{pmatrix}
            AB-XI_n & 0 \\ B & -XI_n
        \end{pmatrix}
    \]
    et \[
        \begin{pmatrix}
            B & -XI_n \\ I_n & -A
        \end{pmatrix} \begin{pmatrix}
            A & -XI_n \\ I_n & 0
        \end{pmatrix} = \begin{pmatrix}
            BA-XI_n & -XB \\ 0 & -XI_n
        \end{pmatrix}
    \]
    donc $\chi_{AB}=\chi_{BA}$
\end{proof}

\begin{proof}[Résolution (Deuxième méthode)]
    Si $A$ inversible, $AB=A(BA)A^{-1}$ donc $\chi_{AB}=\chi_{BA}$. Puis, dans le cas général on se place dans $\K(T)$ (le corps des fractions rationnelles sur $\K$) et $A-TI_n$ est inversible, d'où \[
        \chi_{B(A-TI_n)}=\chi_{(A-TI_n)B}
    \]
    et on prend $T$=0.
\end{proof}

\section{Étude des sous-espaces propres}

\begin{prop}
    \Hyp $E$ un $\K$-e.v. et $u$ un endomorphisme de $E$. On note $\lambda_1, \cdots, \lambda_p$ des valeurs propres de $u$ deux à deux distinctes
    \Conc Les sous-espaces propres $E_\lambda$ sont en somme directe
\end{prop}

\begin{proof}
    C'est le théorème de décomposition des noyaux sur $P=(X-\lambda_1)\cdots (X-\lambda_p)$
\end{proof}

\begin{prop}
    \Hyp $E$ un $\K$-e.v. et $F$ un s.e.v. de $E$ stable par un endomorphisme $u$ de $E$.
    \Conc $\chi_{u_{|F}}$ divise $\chi_u$ et $\mu_{u_{|F}}$ divise $\mu_u$
\end{prop}

\begin{proof}
    $\mu_u(u)=0$ donc $\mu_u(u)_{|F} =\mu_u(u_{|F})=0$ donc $\mu_{u_{|F}} \;|\;\mu_u$. On note $\mathcal F=(e_1, \cdots , e_p)$ une base de $F$ qu'on complète en base $\mathcal B$ de $E$. On note $A=\mathcal M_{\mathbb F}(u_{|F})$. On a \[
        \mathcal M_{\mathcal B}(u)= \left( \begin{array}{c|c}
                 A & * \\ 
                \hline 0 & B
        \end{array} \right)
    \]
    donc $\chi_{u}=\chi_A\chi_B$
\end{proof}

\begin{thmdef}
    \Hyp $u$ endomorphisme en dimension finie
    \begin{concenum}
    \item Si $\lambda\in\Sp_{\K}(u)$ alors on appelle \textbf{multiplicité algébrique}\index{multiplicité algébrique} de $\lambda$ la multiplicité de $\lambda$ dans $\chi_u$, notée $m_\lambda(u)$
    \item Si $\lambda\in\Sp_{\K}(u)$ alors $1\leq \dim E_{\lambda}(u)\leq m_\lambda(u)$
    \end{concenum}
\end{thmdef}

\begin{proof}
    \[x\in \Ker (u-\lambda\id)\implies  (u-\lambda\id)^r(x)=(u-\lambda\id)^{r-1}\circ (u-\lambda\id)(x)=0\implies x\in \Ker((u-\lambda\id)^r)\] puis théorème de décomposition des noyaux
\end{proof}

\section{Endomorphismes diagonalisables}

\begin{defprop}
    On note $E$ un $\K$-e.v., $u$ un endomorphisme de $E$. On dira qu'il est \textbf{diagonalisable}\index{diagonalisable (endomorphisme)} s'il satisfait l'une des propriétés équivalentes suivantes: \begin{enumerate}
        \item Il existe une base de $E$ constituée de vecteurs propres pour $u$
        \item Il existe une base de $E$ dans laquelle $u$ a une matrice diagonale
        \item Il existe une base de $E$ dans laquelle la matrice de $u$ est semblable à une matrice diagonale
    \end{enumerate}
\end{defprop}

\begin{thm}
    \Hyp $E$ un $\K$-e.v. de dimension finie, $u$ un endomorphisme, $\lambda_1, \cdots, \lambda_p$ les valeurs propres distinctes de $u$
    \Conc Il y a équivalence entre \begin{enumerate}[label=(\alph{enumi})]
        \item $u$ est diagonalisable
        \item $E_{\lambda_1}(u)\oplus \cdots \oplus E_{\lambda_p}(u)=E$
        \item \[
                \sum_{i=1}^p\dim E_{\lambda_i}(u)=\dim E
            \]
        \item $\chi_u$ est scindé sur $\K$ et $m_{\lambda}(u)=\dim E_{\lambda}(u)$ pour $\lambda\in\Sp_{\K}(u)$
        \item $\mu_u$ scindé à racines simples dans $\K$
        \item Il existe $P$ annulateur scindé à racines simples. Dans ce cas, \[
                \mu_u=\prod_{\lambda\in\Sp_{\K}(u)}(X-\lambda)
            \]
    \end{enumerate}
\end{thm}

\begin{proof}~
    \begin{itemize}
        \item $(a\implies b)$ Il existe une base de vecteurs propres, on les regroupe par valeurs propres et on a le résultat.
        \item $(b\implies c)$ Clair
        \item $(c\implies d)$ $\chi_u=(X-\lambda_1)^{\alpha_1}\cdots (X-\lambda_p)^{\alpha_p}P(X)$ et \[
                \dim E=\sum_{i=1}^p\dim E_{\lambda_i}\leq \sum_{i=1}^pm_{\lambda_i}(u)\leq \dim E
            \]
            donc $P=1$ et \conc
        \item $(d\implies e)$ On a $(d\implies b)$ puis $(b\implies a)$ donc dans $\mathcal B$ adaptée, \[
                A\defeq\mathcal M_{\mathcal B}(u)= \begin{pmatrix}
                    \lambda_1 I_{r_1} &  & (0) \\
                     & \ddots & \\
                    (0) & & \lambda_p I_{r_p}
                \end{pmatrix}
            \]
            et \[ (A-\lambda_1 I_n)\cdots (A-\lambda_p I_n) =
                \begin{pmatrix}
                0 & & & (0) \\
                  &*& & \\
                  & &\ddots &\\
                (0) & & & *
            \end{pmatrix}
                \begin{pmatrix}
                * & & & (0) \\
                  &0& & \\
                  & &\ddots &\\
                (0) & & & *
            \end{pmatrix}\cdots
            \begin{pmatrix}
                * & & & (0) \\
                  &\ddots& & \\
                  & &* &\\
                (0) & & & 0
            \end{pmatrix}
        \]
        donc $(X-\lambda_1)\cdots (X-\lambda_p)$ annulateur scindé à racines simples
    \item $(e\implies f)$ Clair
    \item $(f\implies a)$ TDN sur $P$ puis on enlève les $E_{\lambda_i}(u)=\{0\}$ dans la décomposition
    \end{itemize}
\end{proof}

\begin{exo}
    On note \[
        A= \begin{pmatrix}
            -3 & 4 & 0 \\ 1 & 3 & 3 \\ 1 & -2 & 0
        \end{pmatrix}
    \]
    Calculer $\chi_A$. $A$ est-elle diagonalisable ? Si oui, diagonaliser $A$.
\end{exo}

\begin{proof}[Résolution (partielle)]
    $\chi_A(X)=(X+3)(X-1)(X-2)$ annulateur scindé à racines simples donc $A$ diagonalisable. Les trois vecteurs \[
        \begin{pmatrix}
            1\\1\\-1
        \end{pmatrix}
        \qquad \qquad
        \begin{pmatrix}
            4\\5\\-3
        \end{pmatrix}
        \qquad \qquad
        \begin{pmatrix}
            -3\\0\\1
        \end{pmatrix}
    \]
    sont des vecteurs propres.
\end{proof}

\begin{exo}
    $A\in\mathrm{GL}(\C)$. Montrer que $A^2$ est diagonalisable si et seulement si $A$ l'est.
\end{exo}

\begin{proof}[Éléments de résolution]
    Le sens réciproque est immédiat, on ne montre que le sens direct. Si $A^2$ est diagonalisable de valeurs propres $\lambda_1, \cdots, \lambda_p$, on écrit $\delta_i^2=\lambda_i$ et $X^2-\delta_i^2=(X-\delta_i)(X+\delta_i)$ donc TDN et $\Ker(A^2-\lambda_i I_n)=\Ker(A-\delta_iI_n)\oplus\Ker(A+\delta_i I_n)$
\end{proof}

\begin{exo}
    Donner une CNS de diagonalisabilité pour une matrice diagonale par blocs
\end{exo}

\begin{proof}[Réponse]
    Une matrice $A=\diag(A_1, \cdots, A_p)$ est diagonalisable ssi les $A_i$ le sont.
\end{proof}

\section{Sous-espaces stables}

\subsection{Restriction}

\begin{prop}
    \Hyp $u$ endomorphisme diagonalisable (dimension finie), $V$ s.e.v. stable par $u$.
    \Conc $u_{|V}$ est diagonalisable et \[
        V=\bigoplus_{\lambda\in\Sp_{\K}(u)}E_\lambda(u)\cap V
    \]
\end{prop}

\begin{proof}
    $\mu_u$ scindé annulateur à racines simples et $E_\lambda(u_{|V})=E_\lambda(u)\cap V$
\end{proof}

\subsection{Décomposition de Dunford (HP)}

\index{Dunford (décomposition de -- )}

\begin{res}
    Soit $u$ un endomorphisme en dimension finie $n$ dont le polynôme caractéristique est scindé, $A$ sa matrice dans une base $\mathcal B$. Il existe une matrice diagonalisable $D$ et une matrice nilpotente $N$ qui commutent et telles que $A=D+N$. Cette écriture est unique.
\end{res}

\begin{proof}
    On suppose $\chi_A=(X-\lambda_1)^{\alpha_1}\cdots (X-\lambda_r)^{\alpha_r}$ avec les $\lambda_i$ deux à deux distincts et les $\alpha_i\geq 1$.

    Le théorème de décomposition des noyaux donne \[
        \mathcal M_{n, 1}(\K)=\underbrace{\Ker(A-\lambda_1I_n)^{\alpha_1}}_{\defeq \Gamma_1(A)}\oplus\cdots \oplus \Gamma_r(A).
    \]

    $A$ et $(A-\lambda I_n)^{\alpha_i}$ commutent donc $\Gamma_i(A)$ est stable par $A$ et \[
        (A-\lambda_i I_n)^{\alpha_i}_{|\Gamma_i(A)}=0=(A_{|\Gamma_i(A)}-\lambda_i I_{n|\Gamma_i(A)})^{\alpha_i}
    \]
    d'où \[
        A_{|\Gamma_i(A)}=\underbrace{\lambda_i I_{n|\Gamma_i(A)}}_{D_i \text{ diagonalisable}}+ \underbrace{\left(A_{|\Gamma_i(A)}-\lambda_i I_{n|\Gamma_i(A)}  \right)}_{N_i\text{ nilpotente }}
    \]
    et $D_iN_i=N_iD_i$

    Dans une base $\mathcal F$ adaptée à la décomposition, on a \[
        \mathcal M_{\mathcal F}(A)= \begin{pmatrix}
            D_1+N_1 & & (0)\\
                    &\ddots &\\
            (0)&&D_r+N_r
        \end{pmatrix}
    \]
    et $\chi_A=\chi_{D_1+N_1}\times \cdots \times \chi_{D_r+N_r}=(X-\lambda_1)^{r_1}\cdots (X-\lambda_r)^{r_r}$ avec $r_i=\dim\Gamma_i(R)$. On en déduit $\dim\Gamma_i(A)=\alpha_i$ et on conclut sur l'existence avec \[
        D= \begin{pmatrix}
            D_1 & & \\
                &\ddots &\\
                &&D_r
        \end{pmatrix}
        \qquad \qquad N= \begin{pmatrix}
            N_1&&\\
               &\ddots&\\
               &&N_r
        \end{pmatrix}
        \qquad \qquad DN=ND
    \]

    Par ailleurs, si on note $\pi_i$ le projecteur sur $\Gamma_i(A)$ associé à la décomposition, $\pi_i$ est un polynôme en $A$ (d'après le théorème de décomposition des noyaux) donc $D=\sum \lambda_i\pi_i$ aussi et $N=A-D$ aussi.

    On suppose que $D'$ et $N'$ conviennent aussi. Dans ce cas, $D-D'=N-N'$. $N$ et $N'$ commutent car $N$ est un polynôme en $A$ et $N'$ commute avec $A$ donc $N-N'$ est nilpotente. $D-D'$ est diagonalisable nilpotente donc nulle ce qui conclut sur l'unicité.
\end{proof}

\subsection{Diagonalisation simultanée}

On va montrer que si $(f_i)_{i\in I}$ est une famille d'endomorphismes diagonalisables qui commutent alors on peut les diagonaliser dans une base commune.

On procède par récurrence sur $n=\dim E$.
\begin{itemize}
    \item $n=1$ c'est trivial
    \item $n\geq 1$, on suppose que c'est vrai au rang $n$ et on prend $E$ tel que $\dim E=n+1$ \begin{itemize}
        \item \emph{Premier cas.} Tous les $f_i$ sont des homothéties. Il n'y a rien à faire.
        \item \emph{Second cas.} L'endomorphisme $f_{i_0}$ n'est pas une homothétie. \[
                E=\bigoplus_{\lambda\in\Sp_{\K}(f_{i_0})} \underbrace{E_\lambda(f_{i_0})}_{\dim \leq n}.
            \]
            Les $E_\lambda(f_{i_0})$ sont stables par tous les $f_i$ et les $f_{i|E_\lambda(f_{i_0})}$ sont diagonalisables donc il existe une base $\mathcal B_\lambda$ de $E_\lambda(f_{i_0})$ qui les diagonalise (par \hyp). Il suffit de concaténer les $\mathcal B_\lambda$ pour conclure.
    \end{itemize}
\end{itemize}

\section{Utilisation des polynômes d'interpolation}

On note $A\in\mathcal M_n(\K)$, $\Sp_{\K}(A)=\{\lambda_1, \cdots, \lambda_r\}$, $A$ diagonalisable. \begin{itemize}
    \item $\mathcal M_{n, 1}(\K)=E_{\lambda_1}(A)\oplus\cdots \oplus E_{\lambda_r}(A)$
    \item On note \[
            \Delta_i=\prod_{j\neq i}\frac{X-\lambda_j}{\lambda_i-\lambda_j}
        \]
    \item $\Delta_1+\cdots +\Delta_r(X)-1$ est de degré $\leq r-1$ et s'annule en $\lambda_1, \cdots, \lambda_r$ donc c'est le polynôme nul et $\sum \Delta_i=1$
    \item On a $\mu_A=(X-\lambda_1)\cdots (X-\lambda_r)$ donc $(X-\lambda_i)\Delta_i$ est divisible par $\mu_A$ de sorte que $\forall X, \quad \Delta_i(A)X\in E_{\lambda_1}(A)$

        Puis, $\forall X, \Delta_1(A)X+\cdots \Delta_r(A)=X$ donc $\Delta_i(A)$ est le projecteur sur $E_{\lambda_i}(A)$ associé à la décomposition.

        De plus, en appliquant $A$, \[
            \lambda_1\Delta_1(A)X+\cdots + \lambda_r\Delta_r(A)=AX
        \]
        qui est vrai pour tout $X$ donc \[
            A=\lambda_1\Delta_1(A)+\cdots +\lambda_r\Delta_r(A)
        \]

        Pour $i\neq j$, $\Delta_i(A)\Delta_j(A)=0$ (le polynôme est divisible par $\mu_A$) donc par récurrence (presque) immédiate, \[
            \forall k\geq 0, \qquad A^k=\lambda_1^k\Delta_1(A)+\cdots +\lambda_r^k\Delta_r(A)
        \]
\end{itemize}

\begin{ex}
    On note \[
        A= \begin{pmatrix}
            3 & -3 & 2 \\
            -1 & 5 & -2 \\
            -1 & 3 & 0
        \end{pmatrix}
    \]
    et $\chi_A=(X-4)(X-2)^2$ diagonalisable car $\mu_A=(X-4)(X-2)$ est annulateur scindé à racines simples

    Les projecteurs spectraux sont $\Delta_4=\frac{X-2}{4-2}$, $\Delta_2=\frac{X-4}{2-4}$, donc \[
        \forall n\geq 0, A^n=4^n\Delta_4(A)+2^n\Delta_2(A)
    \]
\end{ex}

\section{Trigonalisation}

\begin{thmdef}
    \Hyp $u$ endomorphisme en dimension finie $n$
    \begin{concenum}
    \item On dit que $u$ est trigonalisable\index{trigonalisable (endomorphisme)} s'il existe une base $\mathcal B$ de $E$ telle que $\mathcal M_{\mathcal B}(u)$ est triangulaire
    \item Il y a équivalence entre \begin{enumerate}
        \item $u$ est trigonalisable
        \item $\chi_u$ est scindé sur $\K$
    \end{enumerate}
    En particulier, Si $\K=\C$, tous les endomorphismes sont trigonalisables
    \end{concenum}
\end{thmdef}

\begin{proof}
    $(a\implies b)$ Si $\mathcal M_{\mathcal B}(u)=(a_{i, j})$ alors $\chi_u=\displaystyle\prod_{i=1}^n(X-a_{i,i})$ scindé sur $\K$.

    $(b\implies a)$ Par récurrence sur $n$: \begin{itemize}
        \item $n=1$ clair
        \item $n\geq 1$, on suppose la propriété vraie au rang $n$ et on note $E$ tel que $\dim E=n+1$, $u\in\mathcal L(E)$ et $\chi_u$ scindé. On note $e_1$ un vecteur propre associé à la valeur propre $\lambda\in\Sp(u)$, et on complète $(e_1)$ en une base $\mathcal B$ de $E$. \[
                \mathcal M_{\mathcal B}(u)= \left( \begin{array}{c|ccc}
                     \lambda & & * & \\
                    \hline 0 &&&\\
                    \vdots &&A&\\
                    0&&&
                \end{array}\right)
            \]
            et on applique HR sur $A$.
    \end{itemize}
\end{proof}

\begin{rem}
    Si $A\in\mathcal M_n(\C)$ alors il existe $P\in\mathrm{GL}_n(\C)$ telle que \[
        PAP^{-1}= \begin{pmatrix}
            d_1 & & *\\
                &\ddots &\\
            (0)&&d_n
        \end{pmatrix}.
    \]
    \begin{itemize}
        \item $\chi_A=(X-d_1)\cdots (X-d_n)$ donc $\Sp_{\C}(A)=\{d_1, \cdots, d_n\}$
        \item On note $\Sp_{\C}(A)^{\text{comp}}$ le multi-ensemble des valeurs-propres (c'est-à-dire l'ensemble des valeurs propres répétées avec leur multiplicité). On a \[
                \Tr(A)=\sum_{\lambda\in\Sp_{\C}(A)^{\text{comp}}}\lambda\qquad \qquad \quad \Tr(A^k)=\sum_{\lambda\in\Sp_{\C}(A)^{\text{comp}}}\lambda^k
            \]
            et \[
                \det A=\prod_{\lambda\in\Sp_{\C}(A)^{\text{comp}}}\lambda
            \]
    \end{itemize}
\end{rem}

\subsection{Trigonalisation simultanée}

On note $(A_i)_i$ des matrices trigonalisables qui commutent deux à deux. Il existe $P\in\mathrm{GL}_n(\K)$ telle que pour tout $i$, $PA_iP^{-1}$ est triangulaire supérieure.

La démonstration est identique à celle de la diagonalisation simultanée.

\subsection{Trigonalisation effective}

On note \[
    A= \begin{pmatrix}
        0 & 1 & 0 & 2 \\ 
        -3 & 0 & 4 & 0\\
        0 & 1 & 0 & 3\\
        -1 & 0 & 1 & 0
    \end{pmatrix}
\]
On a \[
    \chi_A= \begin{vmatrix}
        X & -1 & 0 & -2 \\ 
        3 & X & -4 & 0\\
        0 & -1 & X & -3\\
        1 & 0 & -1 & X
    \end{vmatrix}= X^4-2X^2+1=(X+1)^2(X-1)^2
\]
La matrice est diagonalisable ssi $\mu_A=(X+1)(X-1)$ ce qui est faux. Le TDN donne \[
    \R^4=\Ker(A-I_4)^2\oplus \Ker(A+I_4)^2
\]
et \[
    (A-I_4)^2= 
    \begin{pmatrix}-4&-2&6&-4\\6&2&-8&6\\-6&-2&8&-6\\2&0&-2&2\end{pmatrix}
\]
d'où \begin{align*}
    \begin{pmatrix}
        x\\y\\z\\t
    \end{pmatrix} \in \Vect(A-I_4)^2 &\iff \begin{cases}
        4x+2y-6z+4t=0 \\
        6x+2y-8z+6t=0 \\
        6x+2y-8z+6t=0 \\
        2x\phantom{+2y\;\,}-2z+2t=0
    \end{cases} \\
    &\iff \begin{cases}
        y=z \\
        x=z-t
    \end{cases}\\
    & \iff
    \begin{pmatrix}
        x\\y\\z\\t
    \end{pmatrix}\in\Vect \left( \begin{pmatrix}
        1\\1\\1\\0
        \end{pmatrix}, \underbrace{\begin{pmatrix}
        -1\\0\\0\\1
    \end{pmatrix}}_{\not\in\Ker(A-I_4)} \right)
\end{align*}

On note \[
    (e_1, e_2)\defeq \left(  (A-I_4)\begin{pmatrix}
        -1\\0\\0\\1
    \end{pmatrix}, \begin{pmatrix}
        1\\1\\1\\0
        \end{pmatrix}\right)
\]
de sorte que $e_1, e_2\in\Ker(A-I_4)^2$, $(A-I_4)e_1=0$ donc $Ae_1=e_1$ et $Ae_2=e_1+e_2$ donc $(e_1, e_2)$ base de $\Ker(A-I_4)^2$
et \[
    \mathcal M_{(e_1, e_2)}(A_{|\Ker(A-I_4)^2})= \begin{pmatrix}
        1&1\\0&1
    \end{pmatrix}
\]
et on fait pareil sur l'autre noyau.

\subsection{Endomorphisme nilpotent}

\begin{defprop}
    \Hyp $E$ un $\K$-e.v. de dimension $n$
    \begin{concenum}
    \item On dira que $f$ est nilpotent\index{nilpotence!endomorphisme} s'il existe un $p\geq 1$ tel que $f^p=0$.
    \item Il y a équivalence entre \begin{enumerate}
        \item $f$ nilpotent
        \item $\chi_f=X^n$
        \item $f$ trigonalisable de spectre $\{0\}$
    \end{enumerate}
    Dans ce cas, l'indice de nilpotence\index{nilpotence!indice de nilpotence} est le degré de $\mu_f$
    \end{concenum}
\end{defprop}

\begin{proof}~
    \begin{itemize}
        \item $(b\implies a)$ Cayley-Hamilton
        \item $(a\implies c)$ $X^p$ scindé annulateur, $\Sp(f)\subset \{0\}$ et $E_0(f)=\Ker f\neq \{0\}$
        \item $(c\implies b)$ Ok
    \end{itemize}
\end{proof}

\begin{rem}
    Si $f\in\mathcal L(E)$ et si $P$ est annulateur scindé sur $\K$ alors $\mu_f$ est scindé et $\mathcal Z_{\K}(\mu_f)=\Sp_{\K}(f)=\mathcal Z_{\K}(\chi_f)$

    Donc, $\chi_f=(X-\lambda_1)^{\alpha_1}\cdots (X-\lambda_p)^{\alpha_p}Q$ avec $Q$ premier avec $\mu_f$. Si $Q$ non constant alors $Q(f)$ inversible.

    Si $Q$ a des racines dans $\widehat{\K}$, $Q(X)=(X-\lambda)\tilde Q(X)$ dans $\widehat {\K}[X]$ et $f-\lambda\id_E$ non inversible donc $\det Q(f)=\det (f-\lambda\id_E)\det\tilde Q(f)=0$ absurde donc $Q=1$
\end{rem}

\subsection{Caractérisation des matrices nilpotentes}

\begin{exo}
    Montrer que $A\in\mathcal M_n(\C)$ est nilpotente ssi $\Tr A=\Tr A^2=\cdots =\Tr A^n=0$
\end{exo}

\begin{proof}[Résolution]~
    \begin{itemize}
        \item $(\implies)$ Facile
        \item $(\impliedby)$ On note $\lambda_1, \cdots, \lambda_p$ les valeurs propres distinctes non nulles de $A$, et on suppose qu'il y en a. Il existe des $n_1, \cdots, n_p\geq 1$ tels que \[
                \begin{cases}
                    n_1\lambda_1+\cdots+n_p\lambda_p=\Tr A=0\\
                    n_1\lambda_1^2+\cdots+n_p\lambda_p^2=\Tr A^2=0\\
                    \hspace{1.5cm}\vdots
                \end{cases}
            \]
            or \[
                \begin{pmatrix}
                    \lambda_1 & \cdots & \lambda_p \\
                    \vdots & \vdots & \vdots \\
                    \lambda_1^p & \cdots & \lambda_p^p
                \end{pmatrix}
            \]
            est inversible (Vandermonde non nul) donc $(n_1, \cdots, n_p)^\top=(0, \cdots, 0)^\top$ absurde, donc il n'y a pas de valeur propre non nulle, d'où \conc.
    \end{itemize}
\end{proof}

\section{Autour du crochet de Lie}

% \begin{dfn}[Hors-Programme]
%     On appelle \textbf{crochet de Lie\index{crochet de Lie}} la loi de composition interne \[
%         [\cdot, \cdot]: (u, v)\longmapsto u\circ v-v\circ u
%     \]
%     ou matriciellement \[
%         [\cdot, \cdot]: (A, B)\longmapsto AB-BA
%     \]
% \end{dfn}

\begin{dfn}[Hors-Programme]
    On appelle \textbf{crochet de Lie}\index{crochet de Lie} tout loi de composition interne $[\,\cdot\,,\,\cdot\,]:E^2\to E$ bilinéaire alternée qui satisfait la relation de Jacobi\index{Jacobi (identité dans une algèbre de Lie)} \[
        \forall x,y,z \in  E,\qquad [x,[y,z]]+[y,[z,x]]+[z,[x,y]]=0
    \]
    On dira alors que $(E, +, [\,\cdot\,,\,\cdot\,])$ est une \textbf{algèbre de Lie}\index{algèbre de Lie}.
\end{dfn}

\begin{rem}
On n'aborde ici que le cas où le crochet de Lie est le \textbf{commutateur} dans l'espace des endomorphismes d'un espace vectoriel: \[
    \forall  f,g \in  \mathcal  L(E),\qquad  [f,g]=f\circ g-g\circ f
\] 
ou bien matriciellement: \[
    \forall  A,B \in  \mathcal  M_n(\K), \qquad  [A, B]=AB-BA
\] 
\end{rem}

\subsection{Nilpotence de \texorpdfstring{$\varphi: B\longmapsto [A,B]$}{B -> [A,B]} pour $A$ nilpotente}

On note $A\in\mathcal M_n(\K)$ nilpotente, $\varphi:B\longmapsto [A, B]$. On introduit $T_G:B\longmapsto AB$ et $T_D:B\longmapsto BA$. Ces deux endomorphismes commutent et $\varphi=T_G-T_D$. Les deux endomorphismes sont nilpotents (car $A$ nilpotente) donc $\varphi$ aussi

\subsection{Diagonalisabilité de \texorpdfstring{$\varphi: B\longmapsto [A, B]$}{B -> [A,B]} pour $A$ diagonale ou diagonalisable}

\begin{itemize}
    \item Si $A=\diag (\lambda_1, \cdots, \lambda_n)$ alors $\varphi(E_{i, j})=(\lambda_i-\lambda_j)E_{i,j}$ donc $\varphi$ diagonalisable (on a trouvé une base de vecteurs propres)
    \item Si $A$ diagonalisable, on écrit $D=P^{-1}AP$ (notations évidentes) et \[
            \varphi(B)=AB-BA\implies P^{-1}APP^{-1}BP-P^{-1}BPP^{-1}AP=P^{-1}\varphi(B)P=[P^{-1}AP, P^{-1}BP]
        \]
        On note $\psi:B\longmapsto PBP^{-1}$ et $\psi^{-1}\circ \varphi\circ \psi=B\longmapsto [D, B]$ diagonalisable.
\end{itemize}

\section{Commutant d'un endomorphisme diagonalisable}

\begin{dfn}[Hors-Programme]
    On appelle \textbf{commutant}\index{commutant} d'un endomorphisme $u$ l'ensemble des endomorphismes qui commutent avec $u$
\end{dfn}

On note $u\in\mathcal L(E)$, $E$ un $\K$-e.v. de dimension $n$. On suppose $u$ diagonalisable. On note \[
    C(u)=\{v\in\mathcal L(E), \quad u\circ v=v\circ u\}
\]
le commutant de $u$.

\begin{itemize}
    \item Si $\lambda_1, \cdots, \lambda_p$ sont les valeurs propres deux à deux distinctes de $u$ alors \[
            E=E_{\lambda_1}(u)\oplus \cdots \oplus E_{\lambda_p}(u)
        \]
    \item Si $v\in C(u)$ alors chaque s.e.p. est stable par $v$. On note \[
            \begin{matrix}
                \psi: & C(u) & \longrightarrow & \mathcal L(E_{\lambda_1}(u))\times \cdots \times \mathcal L(E_{\lambda_p}(u))\\
                      &v &\longmapsto & \left( v_{|E_{\lambda_1}(u)}, \cdots, v_{|E_{\lambda_p}(u)} \right)
            \end{matrix}
        \]
    \item $\psi$ est une application linéaire injective
    \item Soit $(v_1, \cdots, v_p)\in \mathcal L(E_{\lambda_1}(u))\times \cdots \times \mathcal L(E_{\lambda_p}(u))$. Il y a un antécédent correspondant, donc $\psi$ est un isomorphisme et \[
            \dim C(u)=\sum_{i=1}^p\dim(E_{\lambda_i}(u))^2
        \]
\end{itemize}
\endchapter
