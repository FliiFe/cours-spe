\ifsolo
~

\vspace{1cm}

\begin{center}
\textbf{\LARGE Calcul différentiel} \\[1em]
\end{center}
\tableofcontents
\else
\minitoc
\fi
\thispagestyle{empty}

\ifsolo \newpage \setcounter{page}{1} \fi
\section{Notions, Définitions}

$E$ est un $\mathbb R$-e.v de dimension $n$ (donc isomorphe à $\mathbb R^n$), $F$ un sev de $E$ et $\Omega$ un ouvert de $E$.

\begin{rem}
Pour $a\in\Omega, v\in E, \exists \epsilon>0, \forall t\in ]-\epsilon, \epsilon[, a+tv\in\Omega$ (par définition d'un ouvert)
\end{rem}

\begin{dfn}
On note $f:\Omega \longrightarrow F$. On dira que $f$ possède une dérivée en $a\in\Omega$ selon $v\in E$ si \[
    \lim_{\substack{t\to 0\\ t\neq 0}}\frac{f(a+tv)-f(a)}t
\] existe. On note cette limite $D_vf(a)$.

Si $\mathcal B=(e_1,\cdots, e_n)$ base de $E$ et $f$ a une dérivée en $a\in\Omega$ selon $e_{i_0}$ alors on appelle $i_0$-ième dérivée partielle $D_{e_{i_0}}f(a)$, notée \[
    \frac{\partial f}{\partial x_{i_0}}(a)\qquad \text{ ou }\qquad \partial_{i_0}f(a)
\]
\end{dfn}

\begin{rem}
Pour $\mathcal B=(e_1, \cdots, e_n)$ on note $x\underset{\mathcal B}{\longleftrightarrow}(x_1, \cdot, x_n)$ et on a $f(x)=f(x_1e_1+\cdots + x_ne_n)$ qu'on note abusivement $f(x_1, \cdots, x_n)$. \[
    \frac{f(x+te_1)-f(x)}{t}=\frac{f(x_1+t, x_2, \cdots, x_n)-f(x_1, \cdots, x_n)}{t}
\]
Pour calculer $\partial_if(a)$, on fait comme si les autres variables étaient constantes et on dérive par rapport à $x_i$.
\end{rem}

\begin{rem}
$D_v$ est linéaire
\end{rem}

\begin{rem}
Avoir une dérivée en $a$ n'implique pas la continuité en $a$. Contre-exemple: \[
    f(x, y)=\begin{cases}
    \frac{y^2}x &\text{ si }x\neq 0\\ y & \text{ sinon}
    \end{cases}
\]
\end{rem}

\section{Différentielle}

\begin{defprop}
On note $f:\Omega\longrightarrow F, a\in \Omega$. \begin{enumerate}
    \item On dira que $f$ est différentiable en $a$ s'il existe $\varphi\in\mathcal L(E, F), \epsilon>0$ tels que \[
        \forall h\in\mathcal B_o(0, \epsilon), f(a+h)=f(a)+\varphi(h)+o_0(h)
    \]
    Dans ce cas $\varphi$ est unique et se note $\diff f_a$
    \item Si $f$ est différentiable en $a$ alors $f$ est continue en $a$
    \item Si $f$ est différentiable en $a$ alors $f$ a une dérivée en $a$ selon tout $v$ et \[
        D_vf(a)=df_a(v)
    \]
\end{enumerate}
\end{defprop}

\begin{proof} ~
\begin{enumerate}
    \item Si $\varphi, \psi$ conviennent, $\varphi(tv)-\psi(tv)=o_0(tv)$ ie \[
        \varphi(v)-\psi(v)=o_0(v)\xrightarrow[t\to 0]{}0
    \]
    d'où $\varphi\equiv \psi$.
    \item $f(a+h)=f(a)+\varphi(h)+o_0(h)\xrightarrow[h\to 0]{}f(a)$
    \item \[
        \frac{f(a+tv)-f(a)}{t}=\diff f_a(v)+o_0(v)\xrightarrow[\substack{t\to 0\\t\neq 0}]{}\diff f_a(v)
    \]
\end{enumerate}
\end{proof}

\begin{thmdef}
~ \begin{enumerate}
    \item Soit $f\in\mathcal L(E, F)$ et $a\in E$. La fonction $f$ est différentiable en $a$ et $df_a=f$.
    \item Si $\mathcal B=(e_1, \cdots, e_n)$ est une base de $E$ et si $\pi_i$ est l'application $i$-ième coordonnée alors $\forall a\in E, \diff \pi_i=\pi_i$ se dépend pas de $a$. On note cette application $\diff x_i$.
    \item Si $\mathcal B$ est une base de $E$ et $f$ est différentiable en $a$ alors \[
        \diff f_a=\sum_{i=1}^n\frac{\partial f}{\partial x_i}(a)\diff x_i
    \]
\end{enumerate}
\end{thmdef}

\begin{proof} ~
\begin{enumerate}
    \item $f(a+h)=f(a)+f(h)$
    \item Ok
    \item $h=h_1e_1+\cdots +h_ne_n$, \[
        \diff f_a(h)=h_1\diff f_a(e_1)+\cdots +h_n\diff f_a(e_n)=\sum_{i=1}^n\frac{\partial f}{\partial x_i}(a)\diff x_i
    \]
\end{enumerate}
\end{proof}

\begin{rem}
Pour une fonction $f:\mathbb R\longrightarrow F$, $f'(a)=\diff f_a(1)$
\end{rem}

\section{Calculs de différentielles}

\subsection{Quelques exemples}
\begin{ex} Étude en $0$ de
\[
    f(x, y)=\begin{cases}
    \frac{y^2}x &\text{ si }x\neq 0\\ y & \text{ sinon}
    \end{cases}
\]
\end{ex}

\[
\frac{\partial f}{\partial x}(0, 0)=0 \qquad\qquad \frac{\partial f}{\partial y}(0, 0)=f(0, 1)=1
\]
donc \[
\frac{\partial f}{\partial x}(0, 0) \diff x+ \frac{\partial f}{\partial y}(0, 0)\diff y
\]
existe mais $f$ est non différentiable car non $\mathcal C^0$

\begin{ex} Calcul de la différentielle de
{$f:A\in\mathcal M_n(\mathbb R)\longmapsto A^2$}
\end{ex}

\[
    f(A+H)=f(A)+AH+HA+H^2
\]
et pour une norme sous-multiplicative, $\|H^2\|\leq \|H\|^2=o_0(H)$ donc \[
    \diff f_A(H)=AH+HA
\]

\begin{ex} Calcul de la différentielle de
{$f:M\in GL_n(\mathbb R)\longmapsto M^{-1}$}
\end{ex}

On fixe $M\in GL_n(\mathbb R)$. Alors $\exists \epsilon >0 / \mathcal B_o(M, \epsilon)\subset GL_n(\mathbb R)$. Pour $H$ dans $\mathcal B_o(0, \epsilon)$, \[
    M+H\in\mathcal B_o(M, \epsilon)
\]
et \[
    \left((M+H)^{-1}-M^{-1}\right)(M+H)=I_n-M^{-1}(M+H)=-M^{-1}H
    \] donc
    \begin{align*}
    (M+H)^{-1}-M^{-1}&=-M^{-1}H(M+H)^{-1}\\&=-M^{-1}HM^{-1}+M^{-1}Ho_0(1)\\&=\underbrace{-M^{-1}HM^{-1}}_{\diff f_M(H)}+o_0(H)
\end{align*}

\begin{exo} Calcul de la différentielle de
{$f:A\in\mathcal M_n(\mathbb R)\longmapsto A^\intercal A$}
\end{exo}

\subsection{Interprétation matricielle}

\begin{thmdef}
On note $f:\Omega\to \mathbb R^m$, $\Omega\subset \mathbb R^n$, on écrit $f=(f_1, \cdots, f_m)$. On suppose que $f$ est différentiable en $a\in\Omega$ et on note $\mathcal C_n$ (resp. $\mathcal C_m$) la base canonique de $\mathbb R^n$ (resp. $\mathbb R^m$). Alors: \begin{enumerate}
    \item On appelle matrice jacobienne de $f$ en $a$ la matrice \[
        J_f(a)=\left(\frac{\partial f_i}{\partial x_j}(a)\right)_{\substack{1\leq i\leq n\\ 1\leq j\leq n}}
    \]
    \item Si $x\underset{\mathcal C_n}{\longleftrightarrow}X$ alors \[
        \diff f_a(x)\underset{\mathcal C_m}\longleftrightarrow J_f(a)X
    \]
\end{enumerate}
\end{thmdef}

\begin{proof}
\[
    \diff f_a(x)=\sum_{i=1}^n\underbrace{\frac{\partial f}{\partial x_i}(x)}_{\displaystyle \left(\frac{\partial f_1}{\partial x_i}(x), \cdots, \frac{\partial f_m}{\partial x_i}(x)\right)}\overbrace{\diff x_i(x)}^{=x_i} \qquad \underset{\mathcal C_n}{\longleftrightarrow}\qquad \begin{pmatrix}
    \sum_{i=1}^n\limits \frac{\partial f_1}{\partial x_i}(a)x_i \\
    \vdots \\
    \sum_{i=1}^n\limits \frac{\partial f_m}{\partial x_i}(a)x_i 
    \end{pmatrix}=J_f(a)X
\]
\end{proof}

\section{Opérations sur les différentielles}

\begin{prop}
Si $f,g:\omega\subset E\to F$ sont différentiables en $a$, alors pour $\lambda\in\mathbb R$, $\lambda f+g$ est différentiable en $a$ et $\diff (\lambda f+g)_a=\lambda df_a+\diff g_a$
\end{prop}

\begin{prop}
    \Hyp $B:E_1\times E_2\to F$ bilinéaire, $f_1:\Omega_1\to E_1$ différentiable en $a_1$, $f_2:\Omega_2\to E_2$ différentiable en $a_2$.
    \Conc $f=B(f_1, f_2)$ est différentiable en $a=(a_1, a_2)$ et \[\diff f_a(h_1, h_2)=B(\diff {f_1}_{a_1}(h_1), f_2(a_2))+B(f_1(a_1), \diff {f_2}_{a_2}(h_2)) \]
\end{prop}

\begin{proof}
On développe $f(a+h)=B(f_1(a_1+h_1), f_2(a_2+h_2))$
\end{proof}

\begin{ex} ~
\begin{itemize}
    \item $(E, (\; |\; ))$ euclidien, $\varphi:(x, y)\longmapsto (x|y)$ \[
        \diff \varphi_{(x, y)}(h, k)=(h|y)+(x|k)
    \]
    \item $\varphi = \det $. On note \[
        A = (C_1 \cdots C_n) \quad H=(H_1 \cdots H_n)
    \]
    alors \[
        \det(A+H)=\det(A)+\det(H_1, C_2, \cdots, C_n)+\cdots + \det(C_1, \cdots, C_{n-1}, H_n)+o_0(H)
    \]
    On en déduit \begin{align*}
        \diff \varphi_A(H) &= \sum_{j=1}^n \det(C_1, \cdots, H_i, \cdots, C_n)\\
        &= \sum_{j=1}^n\sum_{i=1}^n(-1)^{i+j}h_{i, j}\Delta_{i, j}(A) \\
        &= \Tr(\Com(A)^\intercal H)
    \end{align*}
\end{itemize}
\end{ex}

\section{Composition des fonctions différentielles}

\begin{prop}
    \Hyp $f : \Omega \subset E \to F$ différentiable en $a$ telle que $f(\Omega)\subset \Omega'$, $g : \Omega'\subset F \to G$ différentiable en $f(a)$
    \Conc $g\circ f$ est différentiable en $a$ et $\diff (g\circ f)_a=\diff g_{f(a)}\circ \diff f_a$
\end{prop}

\begin{proof}
    On a \[
        g(f(a)+k)=g(f(a))+\diff g_{f(a)}(k)+o(k)
    \]
    et \[
        f(a+h)=f(a)+\underbrace{\diff f_a(h)+o(h)}_{k}
    \]
    donc \[
        g\circ f(a+h)=g(f(a))+\diff g_{f(a)}(\diff f_a(h)+o_0(h)) + \underbrace{o(\underbrace{\diff f_a(h)+o_0(h)}_{o(h)})}_{o(h)}
    \]
    d'où \conc
\end{proof}

\begin{rem}
    $E=\mathbb R^n$, $F=\mathbb R^m$, $G=\mathbb R^p$, $f=(f_1, \cdots, f_m):E\to F$, $g=(g_1, \cdots, g_p):F\to G$, $\mathcal C_k$ base canonique de $\mathbb R^k$.

    Si $x \underset{\mathcal C_n}\longleftrightarrow X$ alors $\diff f_a(x)\underset{\mathcal C_m}\longleftrightarrow J_f(a)X$ et $\diff (g\circ f)_a(x)\underset{\mathcal C_p}\longleftrightarrow J_{g\circ f}(a)X\underset{\mathcal C_p}\longleftrightarrow J_g(f(a))J_f(a)X$. C'est vrai pour tout $X$ donc \[
        \underbrace{J_{g\circ f}(a)}_{\in\mathcal M_{p,n}} = \underbrace{J_g(f(a))}_{\in\mathcal M_{p,m}}\underbrace{J_f(a)}_{\in \mathcal M_{m,n}}
    \]
    On va identifier le coefficient $i, j$. \begin{align*}
        & \left[ J_{g\circ f}(a) \right]_{i, j}=\sum_{k=1}^m \left[ J_g(f(a)) \right]_{i, k} \left[ J_f(a) \right]_{k, j} \\ 
        \iff & \frac{\partial (g_i\circ f)}{\partial x_j} (a)=\sum_{k=1}^m \frac{\partial g_i}{\partial y_k}(f(a)) \frac{\partial f_k}{\partial x_j} (a) \\
        \iff & \colorboxed{red}{\partial_i (g_i\circ f)(a)=\sum_{k=1}^m\partial_kg_i(f(a))\partial_jf_k(a)} \quad \text{ \emph{(règle de la chaîne)} }
    \end{align*}

    En particulier, si $p = n = 1$, $\varphi:t\in \mathbb R\to g(f_1(t), \cdots, f_m(t))$ alors \[
        (g\circ f)'(a)=\sum_{k=1}^m \frac{\partial g}{\partial y_k}(f(a))f'_k(a)
    \]
\end{rem}

\begin{rem}
    Si $f:\Omega\subset E\to \mathbb R$ est différentiable en $a$ et $f(a)\neq 0$ alors $\frac 1f$ est différentiable en $a$ car $x\longmapsto \frac 1x$ est différentiable en $f(a)$
\end{rem}

\begin{rem}
    Si $f:\Omega\subset E\to F$ est $a\in\Omega$, $v\in E$ alors $\varphi:t \longmapsto f(a+tv)$ est définie au $\mathcal V(0)$ et $\varphi'(t)=\diff f_{a+tv}(v)$
\end{rem}

\needspace{5cm}
\section{Applications de classe {$\mathcal C^1$}}

\begin{thmdef}
    \Hyp $f:\Omega\subset E\longrightarrow F$
    \begin{concenum}
    \item On dira que $f$ est $\mathcal C^1$ sur $\Omega$ si $f$ est différentiable sur $\Omega$ et si $a\in\Omega \longmapsto \diff f_a\in\mathcal L(E, F)$ est $\mathcal C^0$
        \item Une fonction $\mathcal C^1$ est continue
        \item On note $\mathcal B=(e_1, \cdots, e_n)$ une base de $E$, $\mathcal C=(u_1, \cdots, u_m)$ une base de $F$ et $f=(f_1, \cdots, f_m)$. Il y a équivalence entre: \begin{enumerate}
            \item $f$ est $\mathcal C^1$ sur $\Omega$
            \item Les $f_i$ ont toutes leurs dérivées partielles sur $\Omega$ et les $\partial_jf_i$ sont $\mathcal C^0$ sur $\Omega$
        \end{enumerate}
    \item On note $\mathcal C^1(\Omega, F)$ l'ensemble de ces fonctions
    \end{concenum}
\end{thmdef}

\begin{proof}~
    \begin{enumerate}
        \setcounter{enumi}{1}
        \item Les fonctions $\mathcal C^1$ sont différentiables donc continues.
        \item $(a) \implies (b)$: \[
                J_f(a)=\mathcal M_{\mathcal B, \mathcal C}(\diff f_a)= \left( \frac{\partial f_i}{\partial x_j} (a) \right)_{\substack{1\leq i\leq m\\1\leq j\leq n}}
            \]
            est continue par rapport à $a$ par hypothèse.

            $(b) \implies (a)$: \todo{ce sens là}
    \end{enumerate}
\end{proof}
