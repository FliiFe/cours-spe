\ifsolo
    ~

    \vspace{1cm}

    \begin{center}
        \textbf{\LARGE Suites et Séries de fonctions} \\[1em]
    \end{center}
    \tableofcontents
\else
    \chapter{Suites et Séries de fonctions}

    \minitoc
\fi
\thispagestyle{empty}

Dans tout le chapitre, $I$ est un intervalle non trivial, $A$ est une partie non vide de $\R$ et $K=\R$ ou $\C$. Plus tard, on pourra remplacer $A$ par une partie d'un e.v.n (de dimension finie généralement) et $K$ un e.v.n.

\section{Différents types de convergence}

\begin{dfn}
    On note $(f_n)_n$ une suite de fonctions de $I$ dans $K$. \begin{enumerate}
        \item On dit que $(f_n)_n$ \emph{converge simplement}\index{convergence simple} (CVS) s'il existe $f:I\to K$ telle que $\forall x\in I, f_n(x)\xrightarrow[n\to+\infty]{} f(x)$
        \item On dit que $(f_n)_n$ \emph{converge uniformément}\index{convergence uniforme} (CVU) s'il existe $f:I\to K$ telle que \begin{itemize}
            \item $(f_n-g)$ est bornée à partir d'un certain rang
            \item $\sup_I|f_n-g|\xrightarrow[n\to+\infty]{}0$
        \end{itemize}
    \item On dit que $(f_n)$ converge uniformément sur tout segment (CVUTS) si pour tout segment $J\subset I$, on a $f_n\xrightarrow[J]{\mathrm{CVU}}f$
    \end{enumerate}
    Dans chacun des cas, on peut remplacer $I$ par $A$.
\end{dfn}

\begin{rem}
    \begin{itemize}
        \item CVU $\implies$ CVUTS $\implies$ CVS
        \item CVS $\centernot\implies$ CVUTS $\centernot \implies$ CVU
    \end{itemize}
\end{rem}

\begin{rem}
    La limite uniforme d'une suite uniformément convergente est identique à la limite simple de cette suite. En particulier, on a unicité de la limite pour les trois convergences.
\end{rem}

\section{Opérations simples sur les convergences}

\begin{prop}
    \Hyp $(u_n)_n,(v_n)_n$ sont des suites de fonctions de $I$ dans $K$, $u,v:I\to K$, $\lambda\in K$.
    \Conc Si $u_n\xrightarrow{}u$, $v_n\xrightarrow v$ avec de la convergence simple (resp. CVUTS, CVU) alors \[
        (\lambda u_n+v_n)\xrightarrow{}\lambda u+v
    \]
    avec la convergence simple (resp. CVUTS, CVU).
\end{prop}

\begin{proof}
    Évident.
\end{proof}

\begin{rem}
Pour la convergence simple, on a $u_nv_n \longrightarrow uv$, mais pas pour la  CVU ou la CVUTS. Par exemple, \[
\begin{matrix}
    u:& \R_+ & \longrightarrow &\R  \\
    & x & \longmapsto & e^x+\frac{1}{n}
\end{matrix}
\] 
On a \[
    u_n \xrightarrow[\R_+]{\text{CVU}} u
\] 
On a aussi  \[
    u_n^2 \xrightarrow[\R_+]{\text{CVS}} u^2
\]
donc si $u_n^2$ converge uniformément, \[
    u_n^2(x)-u^2(x) = \frac{2e^x}{n}+\frac{1}{n^2} \xrightarrow[n\to+\infty]{}0
\] 
ce qui est absurde
\end{rem}

\begin{prop}[Propriétées héritées par CVS]
    \Hyp $u_n: I\to \K$, $u_n \xrightarrow[]{\text{CVS}} u$ sur $I$
    \Conc La monotonie, la convexité, le caractère $k$-lipschitzien, la positivité sont hérités.
\end{prop}

\begin{proof}
On écrit les inégalités et on passe à la limite.
\end{proof}

\section{Propriétés héritées par CVU}

\begin{thm}[Double limite\index{double limite (théorème)}]
    \Hyp $u_n \xrightarrow[]{\text{CVU}} u$ sur $A$,  $a$ point adhérent de  $A$,  $u_n(x) \xrightarrow[x\to a]{}\ell _n \in  \K$
    \begin{concenum}
    \item $(\ell _n)$ converge vers $\ell  \in \K$
    \item La fonction $u$ a pour limite  $\ell $ en $a$, i.e.  \[
            \lim_{\substack{x \to  a\\x \in  A}} \lim_{x \to  +\infty} u_n(x)=\lim_{n \to  +\infty}\lim_{\substack{x \to  a\\ x \in  A}} u_n(x)
    \] 
    \end{concenum}
\end{thm}

\begin{proof}~
\begin{enumerate}
    \item (admis) On va construire $(n_k)$ strictement croissante telle que  $ \forall  n\geq n_k, |\ell _n-\ell _{n_k}| \leq  \dfrac{1}{2^k}$. \begin{itemize}
        \item $\forall \epsilon>0, \exists  N \in  \N, \forall  n\geq N, \forall  x \in  A, |u_n(x)-u(x)|\leq \epsilon'$
        \item $\forall  n, p\geq N, |u_n(x)-u_p(x)|\leq |u_n(x)-u(x)|+|u(x)-u_p(x)|\leq 2\epsilon'=\epsilon$ et $x \longrightarrow a$ donne  $|\ell _n-\ell _p|\leq \epsilon$
        \item Pour $\epsilon=1$, il existe  $n_0 \in  \N$ tel que $\forall n\geq n_0, |\ell _n-\ell _{n_0}|\leq 1$
        \item Pour $k \in  \N$, si on suppose $n_0<\cdots <n_k$ construits, pour $\epsilon=\frac{1}{2^{k+1}}$, il existe $N \in  \N$ tel que $\forall  p \geq N, |\ell  _n-\ell _p|\leq \epsilon$. On prend $n_{k+1}=\max(N, n_0,\cdots , n_k+1)$.
    \end{itemize}
    Puis $|\ell _{n_{k+1}}-\ell _{n_k}|\leq \frac{1}{2^k}$, c'est le terme général d'une série convergente donc $(\ell _{n_k})$ converge.

     Soit $\epsilon>0$. Il existe $K$ tel que  $k\geq K$, $\frac{1}{2^k}\leq \epsilon'$ et $|\ell  -\ell _{n_k}|\leq \epsilon'$ donc pour $n\geq n_k$, \[
    |\ell _n-\ell |\leq |\ell _n-\ell _{n_k}|+|\ell _{n_k}-\ell |\leq 2\epsilon'=\epsilon
    \] 
    donc $\ell _n \longrightarrow \ell $ 
\item On suppose $a \in  \R$. Soit $\epsilon>0$.  \begin{itemize}
    \item $\exists N \in  \N, \forall  n \geq  N, \forall  x \in  A, \quad  |u_n(x)-u(x)|\leq \epsilon'$
    \item $\exists N_1 \in  \N, \forall  n\geq N_1, \quad  |\ell _n-\ell |\leq \epsilon'$
    \item $M=\max(N, N_1). \qquad  \exists \delta>0, \forall  x \in  ]a-\delta, a+\delta[\cap A, |u_M(x)-\ell _M|\leq \epsilon'$.
\end{itemize}
Donc $|u(x)-\ell |\leq |u(x)-u_M(x)|+|u_M(x)-\ell _M| + |\ell _M-\ell |\leq 3\epsilon'=\epsilon$
\end{enumerate}
\end{proof}

\begin{rem}
    $a$ est un point adhérent  si et seulement si $ \exists  (a_n) \in  A^{\N}, a_n \longrightarrow a$
\end{rem}

\begin{cor}
    \Hyp $(u_n)$ une suite de fonctions continues sur  $A$ qui converge uniformément sur  $A$ vers  $u$
    \Conc  $u$ est continue sur  $A$
\end{cor}

\begin{proof}
    $a \in  A$ donc $a$ est un point adhérent de  $A$,  $u_n \xrightarrow[A]{\text{CVU}}u$ et $\forall  n \in  \N$, \[
        \lim_{\substack{x \to  a\\x \in  A}}u_n(x)=u_n(a) \quad (=\ell _n)
    \] 
    et TDL: \[
        \lim_{\substack{x \to  a\\x \in  A}}u(x)=\lim_{n \to  +\infty}u_n(x)=u(a)
    \] 
\end{proof}

\section{Convergence uniforme, dérivation, intégration}

\begin{thm}
    \Hyp $u_n:I\to K$, $u:I\to K$ et $u_n \xrightarrow[I]{\text{CVUTS}}u$, $a \in  I$, $u_n$ et  $u$ sont $\CPM(I, \K)$. On note $U_n:x \in  I \longmapsto \displaystyle\int_a^xu_n$ et $U:x \in  I \longmapsto \displaystyle \int_a^x u$
    \Conc $U_n \xrightarrow[I]{\text{CVUTS}} U$ et en particulier $ \forall \alpha, \beta \in  I, \displaystyle \int_{\alpha}^\beta u_n \xrightarrow[n\to+\infty]{}\int_\alpha^\beta u$
\end{thm}

\begin{proof}
    $[\alpha, \beta] \subset I, J$ plus petit segment qui contient  $a, \alpha, \beta$. On a sur $J$, avec $\mu(J)=\int_J\diff x$ (constant): \[
        \|U_n-U\|_{\infty}\leq \mu(J) \|u_n-u\|_\infty \xrightarrow[n\to+\infty]{}0
    \] 
    donc $U_n \xrightarrow[J]{\text{CVU}}U$ d'où la conclusion sur la CVUTS. Puis, \[
        \int_\alpha^\beta u_n=U_n(\beta)-U_n(\alpha) \xrightarrow[n\to+\infty]{}U(\beta)-U(\alpha)
    \] 
\end{proof}

\begin{ex}
    $u_n:x \in  [0, 1] \longmapsto n^2x^n(1-x)$ converge simplement vers la fonction nulle. Puis \[
        \int_0^1 u_n = n^2 \left( \frac{1}{n+1}-\frac{1}{n+2} \right) \xrightarrow[n\to+\infty]{}1\neq \int_0^10=0
    \] 
    donc il n'y a pas CVU.
\end{ex}

\begin{thm}[Dérivation]
    \Hyp $(u_n)$ suite de fonctions $\mathcal  C^1$ sur  $I$, telles que \[
        u_n \xrightarrow[I]{\text{CVS}}u \qquad  \text{ et }\qquad  u_n' \xrightarrow[I]{\text{CVUTS}}v
    \] 
    \begin{concenum}
    \item  $u_n \xrightarrow[I]{\text{CVUTS}}u$
    \item $v$ est continue et  $u'=v$
    \end{concenum}
\end{thm}

\begin{proof}
    On se donne  $a \in  I$ fixé, on écrit \[
        u_n(x)=u_n(a)+\int_a^xu_n'
    \] 
    et $n\to +\infty$ donne \[
        u(x)=u(a)+\int_a^xv
    \] 
    donc $u$ est  $\mathcal C^1$ et $u'=v$. Puis,  \[
        \int_a^xu_n \xrightarrow[I]{\text{CVUTS}}\int_a^x u'
    \] 
    donc \[
        u_n \xrightarrow[I]{\text{CVUTS}}u
    \] 
\end{proof}

\begin{thm}[Dérivation itérée]
    \Hyp \index{dérivation itérée (suite de fonctions)} $(u_n)$ fonctions  $\mathcal  C^p$, \[
        \forall  k \in  \llbracket 0, p-1 \rrbracket , \qquad  u_n^{(i)}\xrightarrow[I]{\text{CVS}}\varphi_i
    \] 
    et  \[
        u_n^{(p)}\xrightarrow[I]{\text{CVUTS}}\varphi_p
    \] 
    \begin{concenum}
    \item Il y a CVUTS à la place de la CVS pour toutes les dérivées d'ordre  $\leq p$
    \item $\varphi_0$ est  $\mathcal  C^p$ et $\varphi_0^{(k)}=\varphi_k$
    \end{concenum}
\end{thm}

\begin{proof}
    Admis. (Récurrence)
\end{proof}

\begin{thm}[Convergence dominée\index{convergence dominée (suites)}]
    \Hyp $(u_n), u$ des fonctions  $\CPM(I, \K)$, $u_n \xrightarrow[I]{\text{CVS}}u$\\ $ \exists \varphi \in  \mathcal  L^1(I, \R_+), \quad  \forall  x \in  I, \forall  n \in  \N, \quad  |u_n(x)|\leq \varphi(x)$
    \begin{concenum}
    \item $u_n$ et $u$ intégrable sur $I$
    \item  $\displaystyle \lim_{n\to +\infty}\int_Iu_n=\int_Iu$
    \end{concenum}
\end{thm}

\begin{proof}
Admis
\end{proof}

\begin{rem}
On note \[
\begin{matrix}
    f_n:& \R_+ & \longrightarrow &\R  \\
    & x & \longmapsto & \dfrac{x^ne^{-x}}{n!}
\end{matrix}
\] 
Les $f_n$ sont  $\mathcal  C^1$ et \[
    f_n'(x)=\frac{e^{-x}}{n!}\left( -x^n+nx^{n-1} \right) =\frac{x^{n-1}e^x(n-x)}{n!}
\] 
Le calcul donne \[
    \sup_{\R_+}|f_n| \xrightarrow[n\to+\infty]{}0 \qquad  \text{ donc } \qquad  f_n \xrightarrow[\R_+]{\text{CVU}}0
\]
Les $f_n$ sont intégrables (ce sont des $o(\frac{1}{x^2})$) et \[
    \int_0^{+\infty}f_n= \underbrace{\left[ -\frac{x^ne^{-x}}{n!} \right]_0^{+\infty}}_{=0}+\int_0^{+\infty} \frac{x^{n-1}}{(n-1)!}e^{-x}\diff x=\cdots =\int_0^{+\infty}e^{-x}\diff x=1
\]
Ainsi  \[
    \lim_{n\to +\infty} \int_0^{+\infty} \frac{x^ne^{-x}}{n!}\diff x=1 \neq  \int_0^{+\infty} \left( \lim_{n\to +\infty}f_n(x) \right) \diff x=0
\] 
Le théorème ne s'applique pas sans hypothèse de domination
\end{rem}

\begin{ex}
\[
\Gamma:x\longmapsto \int_{{0}}^{{+\infty}} {e^{-t}t^{x-1}}\;\diff t
\] 
Cette fonction est bien définie car l'intégrande est intégrable. On note \[
    f_n:t\longmapsto \1_{[0,n]}(t) \left( t-\frac{t}{n} \right) ^nt^{x-1}
\]
Ce sont des fonctions $\CPM$ sur  $\R_+^\star$. On a \[
    f_n \xrightarrow[\R_+^\star]{\text{CVS}}e^{-t}t^{x-1}
\]
Donc $\forall  n \in  \N^\star,$ \[ \forall  t >0, \qquad  0\leq f_n(t)\leq \1_{[0, n]}\exp\left(n \ln \left(1-\frac{t}{n}\right)\right)\leq e^{-t}t^{x-1} \]
et le membre de droite est $\CPM$ intégrable. Par convergence dominée,  \[
    \int_{0}^{+\infty} f_n \xrightarrow[t\to +\infty]{}\int_0^{+\infty}f=\Gamma(x) 
\] 
Puis (calculer) \[
    \int_0^{+\infty}f_n=\frac{n^xn!}{x(x+1)\cdots (x+n)}
\] 
donc \[
    \frac{n^xn!}{x(x+1)\cdots (x+n)} \xrightarrow[n\to+\infty]{}\Gamma(x)
\] 
\end{ex}

\section{Méthodes pour la convergence uniforme}

On suppose que l'on a une suite $(u_n)_n$ de fonctions de  $I$ dans  $\C$ et $u$ de  $I$ dans  $\C$ telle que \[
    u_n \xrightarrow[I]{\text{CVS}}u
\]
Comment établir $u_n \xrightarrow[I]{\text{CVS}}u$ ?
\begin{itemize}
    \item Étude de $|u_n-u|$ (ou $u_n-u$ pour les fonctions réelles)
    \item On trouve $(a_n)$ tel que  $\forall  x \in  I, \quad  |u_n(x)-u(x)|\leq a_n$ et $a_n\longrightarrow 0$
    \item Autre (il faut réfléchir)
\end{itemize}

Comment montrer qu'il n'y a pas CVU ?
\begin{itemize}
    \item Étudier $\sup_I|u_n-u|$ et vérifier que ça ne tend pas vers  $0$
    \item Trouver  $(x_n)$ tel que  $(u_n-u)(x_n)$ ne tend pas vers  $0$
    \item Trouver un segment  $I$ tel que  $\int_I u_n$ ne tend pas vers  $\int_Iu$
    \item Régularité de la limite simple
    \item Autre (réfléchir)
\end{itemize}

\subsection{Un premier exemple}

\[
    f_n(x)= \begin{cases}
        \dfrac{\sin(n^2x)^2}{n\sin x} &\text{ si } x \in  ]0, \frac{\pi}{2}]\\
        0 &\text{si }x=0
    \end{cases}
\] 
On a \[
    f_n \xrightarrow[]{\text{CVS}}0
\] 
mais \[
    f_n \left( \frac{1}{n} \right) \underset{}\sim \sin(n)^2 \xnrightarrow{}0
\] 
donc il n'y a pas CVU.
